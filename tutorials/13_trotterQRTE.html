<!doctype html>
<html class="no-js" lang="en">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="../genindex.html" /><link rel="search" title="Search" href="../search.html" /><link rel="next" title="Release Notes" href="../release_notes.html" /><link rel="prev" title="Gradient Framework" href="12_gradients_framework.html" />

    <!-- Generated with Sphinx 7.1.2 and Furo 2023.05.20 -->
        <title>Quantum Real Time Evolution using Trotterization - Qiskit Algorithms 0.2.2</title>
      <link rel="stylesheet" type="text/css" href="../_static/styles/furo.css?digest=e6660623a769aa55fea372102b9bf3151b292993" />
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=82a976d7" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/qiskit-sphinx-theme.css?v=4f054d5c" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/qiskit-ecosystem.css?v=745c5aa7" />
    <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css?v=0a3b3ea7" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo-extensions.css?digest=30d1aed668e5c3a91c3e3bf6a60b675221979f0e" />
    <link rel="stylesheet" type="text/css" href="../_static/nbsphinx-gallery.css" />
    
    


<style>
  body {
    --color-code-background: #ffffff;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style><link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Mono:wght@400;600&family=IBM+Plex+Sans:ital,wght@0,400;0,600;1,400;1,600&display=swap" rel="stylesheet">
<script src="../_static/js/web-components/top-nav-bar.js"></script></head>
  <body>
    
    <script>document.body.dataset.theme = "light";</script>
    
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg id="icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32">
      <defs><style>.cls-1{fill:none;}</style></defs>
      <path d="M28,4H4A2,2,0,0,0,2,6V26a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V6A2,2,0,0,0,28,4ZM4,6H20V26H4ZM28,26H22V6h6Z"/>
      <rect id="_Transparent_Rectangle_" data-name="&lt;Transparent Rectangle&gt;" class="cls-1" width="32" height="32"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg id="icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32">
      <defs><style>.cls-1{fill:none;}</style></defs>
      <rect x="4" y="6" width="24" height="2"/>
      <rect x="4" y="24" width="24" height="2"/>
      <rect x="4" y="12" width="24" height="2"/>
      <rect x="4" y="18" width="24" height="2"/>
      <rect id="_Transparent_Rectangle_" data-name="&lt;Transparent Rectangle&gt;" class="cls-1" width="32" height="32"/>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg version="1.1" id="icon" xmlns="http://www.w3.org/2000/svg" x="0px" y="0px"
         viewBox="0 0 32 32" style="enable-background:new 0 0 32 32;" xml:space="preserve"><polygon points="22,16 12,26 10.6,24.6 19.2,16 10.6,7.4 12,6 " stroke="currentColor"/>
      <rect id="_x3C_Transparent_Rectangle_x3E_" fill="none" width="32" height="32"/>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../index.html"><div class="brand">Qiskit Algorithms 0.2.2</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><div class="sidebar-brand">
  <a href="https://www.qiskit.org/ecosystem">
    <div class="sidebar-logo-container">
      <img class="sidebar-logo" src="../_static/images/ecosystem-logo.svg" alt="Qiskit Ecosystem logo"/>
    </div>
  </a>
  
  <span class="sidebar-brand-text">Qiskit Algorithms 0.2.2</span>
</div><form class="sidebar-search-container" method="get" action="../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../index.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting_started.html">Getting Started</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../apidocs/qiskit_algorithms.html">API References</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of API References</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../stubs/qiskit_algorithms.AmplificationProblem.html">AmplificationProblem</a></li>
<li class="toctree-l2"><a class="reference internal" href="../stubs/qiskit_algorithms.AmplitudeAmplifier.html">AmplitudeAmplifier</a></li>
<li class="toctree-l2"><a class="reference internal" href="../stubs/qiskit_algorithms.Grover.html">Grover</a></li>
<li class="toctree-l2"><a class="reference internal" href="../stubs/qiskit_algorithms.GroverResult.html">GroverResult</a></li>
<li class="toctree-l2"><a class="reference internal" href="../stubs/qiskit_algorithms.AmplitudeEstimator.html">AmplitudeEstimator</a></li>
<li class="toctree-l2"><a class="reference internal" href="../stubs/qiskit_algorithms.AmplitudeEstimatorResult.html">AmplitudeEstimatorResult</a></li>
<li class="toctree-l2"><a class="reference internal" href="../stubs/qiskit_algorithms.AmplitudeEstimation.html">AmplitudeEstimation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../stubs/qiskit_algorithms.AmplitudeEstimationResult.html">AmplitudeEstimationResult</a></li>
<li class="toctree-l2"><a class="reference internal" href="../stubs/qiskit_algorithms.EstimationProblem.html">EstimationProblem</a></li>
<li class="toctree-l2"><a class="reference internal" href="../stubs/qiskit_algorithms.FasterAmplitudeEstimation.html">FasterAmplitudeEstimation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../stubs/qiskit_algorithms.FasterAmplitudeEstimationResult.html">FasterAmplitudeEstimationResult</a></li>
<li class="toctree-l2"><a class="reference internal" href="../stubs/qiskit_algorithms.IterativeAmplitudeEstimation.html">IterativeAmplitudeEstimation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../stubs/qiskit_algorithms.IterativeAmplitudeEstimationResult.html">IterativeAmplitudeEstimationResult</a></li>
<li class="toctree-l2"><a class="reference internal" href="../stubs/qiskit_algorithms.MaximumLikelihoodAmplitudeEstimation.html">MaximumLikelihoodAmplitudeEstimation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../stubs/qiskit_algorithms.MaximumLikelihoodAmplitudeEstimationResult.html">MaximumLikelihoodAmplitudeEstimationResult</a></li>
<li class="toctree-l2"><a class="reference internal" href="../stubs/qiskit_algorithms.Eigensolver.html">Eigensolver</a></li>
<li class="toctree-l2"><a class="reference internal" href="../stubs/qiskit_algorithms.EigensolverResult.html">EigensolverResult</a></li>
<li class="toctree-l2"><a class="reference internal" href="../stubs/qiskit_algorithms.NumPyEigensolver.html">NumPyEigensolver</a></li>
<li class="toctree-l2"><a class="reference internal" href="../stubs/qiskit_algorithms.NumPyEigensolverResult.html">NumPyEigensolverResult</a></li>
<li class="toctree-l2"><a class="reference internal" href="../stubs/qiskit_algorithms.VQD.html">VQD</a></li>
<li class="toctree-l2"><a class="reference internal" href="../stubs/qiskit_algorithms.VQDResult.html">VQDResult</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../apidocs/qiskit_algorithms.gradients.html">Gradients (<code class="xref py py-mod docutils literal notranslate"><span class="pre">qiskit_algorithms.gradients</span></code>)</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle navigation of Gradients (qiskit_algorithms.gradients)</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_algorithms.gradients.BaseEstimatorGradient.html">BaseEstimatorGradient</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_algorithms.gradients.BaseQGT.html">BaseQGT</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_algorithms.gradients.BaseSamplerGradient.html">BaseSamplerGradient</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_algorithms.gradients.EstimatorGradientResult.html">EstimatorGradientResult</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_algorithms.gradients.SamplerGradientResult.html">SamplerGradientResult</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_algorithms.gradients.QGTResult.html">QGTResult</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_algorithms.gradients.FiniteDiffEstimatorGradient.html">FiniteDiffEstimatorGradient</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_algorithms.gradients.FiniteDiffSamplerGradient.html">FiniteDiffSamplerGradient</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_algorithms.gradients.LinCombEstimatorGradient.html">LinCombEstimatorGradient</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_algorithms.gradients.LinCombSamplerGradient.html">LinCombSamplerGradient</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_algorithms.gradients.LinCombQGT.html">LinCombQGT</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_algorithms.gradients.ParamShiftEstimatorGradient.html">ParamShiftEstimatorGradient</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_algorithms.gradients.ParamShiftSamplerGradient.html">ParamShiftSamplerGradient</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_algorithms.gradients.QFIResult.html">QFIResult</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_algorithms.gradients.QFI.html">QFI</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_algorithms.gradients.ReverseEstimatorGradient.html">ReverseEstimatorGradient</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_algorithms.gradients.ReverseQGT.html">ReverseQGT</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_algorithms.gradients.SPSAEstimatorGradient.html">SPSAEstimatorGradient</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_algorithms.gradients.SPSASamplerGradient.html">SPSASamplerGradient</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../stubs/qiskit_algorithms.MinimumEigensolver.html">MinimumEigensolver</a></li>
<li class="toctree-l2"><a class="reference internal" href="../stubs/qiskit_algorithms.MinimumEigensolverResult.html">MinimumEigensolverResult</a></li>
<li class="toctree-l2"><a class="reference internal" href="../stubs/qiskit_algorithms.NumPyMinimumEigensolver.html">NumPyMinimumEigensolver</a></li>
<li class="toctree-l2"><a class="reference internal" href="../stubs/qiskit_algorithms.NumPyMinimumEigensolverResult.html">NumPyMinimumEigensolverResult</a></li>
<li class="toctree-l2"><a class="reference internal" href="../stubs/qiskit_algorithms.VQE.html">VQE</a></li>
<li class="toctree-l2"><a class="reference internal" href="../stubs/qiskit_algorithms.VQEResult.html">VQEResult</a></li>
<li class="toctree-l2"><a class="reference internal" href="../stubs/qiskit_algorithms.AdaptVQE.html">AdaptVQE</a></li>
<li class="toctree-l2"><a class="reference internal" href="../stubs/qiskit_algorithms.AdaptVQEResult.html">AdaptVQEResult</a></li>
<li class="toctree-l2"><a class="reference internal" href="../stubs/qiskit_algorithms.SamplingMinimumEigensolver.html">SamplingMinimumEigensolver</a></li>
<li class="toctree-l2"><a class="reference internal" href="../stubs/qiskit_algorithms.SamplingMinimumEigensolverResult.html">SamplingMinimumEigensolverResult</a></li>
<li class="toctree-l2"><a class="reference internal" href="../stubs/qiskit_algorithms.SamplingVQE.html">SamplingVQE</a></li>
<li class="toctree-l2"><a class="reference internal" href="../stubs/qiskit_algorithms.SamplingVQEResult.html">SamplingVQEResult</a></li>
<li class="toctree-l2"><a class="reference internal" href="../stubs/qiskit_algorithms.QAOA.html">QAOA</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../apidocs/qiskit_algorithms.optimizers.html">Optimizers (<code class="xref py py-mod docutils literal notranslate"><span class="pre">qiskit_algorithms.optimizers</span></code>)</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle navigation of Optimizers (qiskit_algorithms.optimizers)</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_algorithms.optimizers.OptimizerResult.html">OptimizerResult</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_algorithms.optimizers.Optimizer.html">Optimizer</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_algorithms.optimizers.Minimizer.html">Minimizer</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../stubs/qiskit_algorithms.optimizers.optimizer_utils.html">qiskit_algorithms.optimizers.optimizer_utils</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><div class="visually-hidden">Toggle navigation of qiskit_algorithms.optimizers.optimizer_utils</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../stubs/qiskit_algorithms.optimizers.optimizer_utils.LearningRate.html">LearningRate</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_algorithms.optimizers.SteppableOptimizer.html">SteppableOptimizer</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_algorithms.optimizers.AskData.html">AskData</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_algorithms.optimizers.TellData.html">TellData</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_algorithms.optimizers.OptimizerState.html">OptimizerState</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_algorithms.optimizers.ADAM.html">ADAM</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_algorithms.optimizers.AQGD.html">AQGD</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_algorithms.optimizers.CG.html">CG</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_algorithms.optimizers.COBYLA.html">COBYLA</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_algorithms.optimizers.L_BFGS_B.html">L_BFGS_B</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_algorithms.optimizers.GSLS.html">GSLS</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_algorithms.optimizers.GradientDescent.html">GradientDescent</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_algorithms.optimizers.GradientDescentState.html">GradientDescentState</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_algorithms.optimizers.NELDER_MEAD.html">NELDER_MEAD</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_algorithms.optimizers.NFT.html">NFT</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_algorithms.optimizers.P_BFGS.html">P_BFGS</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_algorithms.optimizers.POWELL.html">POWELL</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_algorithms.optimizers.SLSQP.html">SLSQP</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_algorithms.optimizers.SPSA.html">SPSA</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_algorithms.optimizers.QNSPSA.html">QNSPSA</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_algorithms.optimizers.TNC.html">TNC</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_algorithms.optimizers.SciPyOptimizer.html">SciPyOptimizer</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_algorithms.optimizers.UMDA.html">UMDA</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_algorithms.optimizers.BOBYQA.html">BOBYQA</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_algorithms.optimizers.IMFIL.html">IMFIL</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_algorithms.optimizers.SNOBFIT.html">SNOBFIT</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_algorithms.optimizers.CRS.html">CRS</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_algorithms.optimizers.DIRECT_L.html">DIRECT_L</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_algorithms.optimizers.DIRECT_L_RAND.html">DIRECT_L_RAND</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_algorithms.optimizers.ESCH.html">ESCH</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_algorithms.optimizers.ISRES.html">ISRES</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../stubs/qiskit_algorithms.HamiltonianPhaseEstimation.html">HamiltonianPhaseEstimation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../stubs/qiskit_algorithms.HamiltonianPhaseEstimationResult.html">HamiltonianPhaseEstimationResult</a></li>
<li class="toctree-l2"><a class="reference internal" href="../stubs/qiskit_algorithms.PhaseEstimationScale.html">PhaseEstimationScale</a></li>
<li class="toctree-l2"><a class="reference internal" href="../stubs/qiskit_algorithms.PhaseEstimation.html">PhaseEstimation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../stubs/qiskit_algorithms.PhaseEstimationResult.html">PhaseEstimationResult</a></li>
<li class="toctree-l2"><a class="reference internal" href="../stubs/qiskit_algorithms.IterativePhaseEstimation.html">IterativePhaseEstimation</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../apidocs/qiskit_algorithms.state_fidelities.html">State Fidelities (<code class="xref py py-mod docutils literal notranslate"><span class="pre">qiskit_algorithms.state_fidelities</span></code>)</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" role="switch" type="checkbox"/><label for="toctree-checkbox-5"><div class="visually-hidden">Toggle navigation of State Fidelities (qiskit_algorithms.state_fidelities)</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_algorithms.state_fidelities.BaseStateFidelity.html">BaseStateFidelity</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_algorithms.state_fidelities.ComputeUncompute.html">ComputeUncompute</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_algorithms.state_fidelities.StateFidelityResult.html">StateFidelityResult</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../stubs/qiskit_algorithms.RealTimeEvolver.html">RealTimeEvolver</a></li>
<li class="toctree-l2"><a class="reference internal" href="../stubs/qiskit_algorithms.ImaginaryTimeEvolver.html">ImaginaryTimeEvolver</a></li>
<li class="toctree-l2"><a class="reference internal" href="../stubs/qiskit_algorithms.TimeEvolutionResult.html">TimeEvolutionResult</a></li>
<li class="toctree-l2"><a class="reference internal" href="../stubs/qiskit_algorithms.TimeEvolutionProblem.html">TimeEvolutionProblem</a></li>
<li class="toctree-l2"><a class="reference internal" href="../stubs/qiskit_algorithms.PVQD.html">PVQD</a></li>
<li class="toctree-l2"><a class="reference internal" href="../stubs/qiskit_algorithms.PVQDResult.html">PVQDResult</a></li>
<li class="toctree-l2"><a class="reference internal" href="../stubs/qiskit_algorithms.SciPyImaginaryEvolver.html">SciPyImaginaryEvolver</a></li>
<li class="toctree-l2"><a class="reference internal" href="../stubs/qiskit_algorithms.SciPyRealEvolver.html">SciPyRealEvolver</a></li>
<li class="toctree-l2"><a class="reference internal" href="../stubs/qiskit_algorithms.TrotterQRTE.html">TrotterQRTE</a></li>
<li class="toctree-l2"><a class="reference internal" href="../stubs/qiskit_algorithms.VarQITE.html">VarQITE</a></li>
<li class="toctree-l2"><a class="reference internal" href="../stubs/qiskit_algorithms.VarQRTE.html">VarQRTE</a></li>
<li class="toctree-l2"><a class="reference internal" href="../stubs/qiskit_algorithms.VarQTEResult.html">VarQTEResult</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../apidocs/qiskit_algorithms.time_evolvers.variational.html">Time Evolvers, Variational (<code class="xref py py-mod docutils literal notranslate"><span class="pre">qiskit_algorithms.time_evolvers.variational</span></code>)</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" role="switch" type="checkbox"/><label for="toctree-checkbox-6"><div class="visually-hidden">Toggle navigation of Time Evolvers, Variational (qiskit_algorithms.time_evolvers.variational)</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_algorithms.time_evolvers.variational.VariationalPrinciple.html">VariationalPrinciple</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_algorithms.time_evolvers.variational.RealVariationalPrinciple.html">RealVariationalPrinciple</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_algorithms.time_evolvers.variational.ImaginaryVariationalPrinciple.html">ImaginaryVariationalPrinciple</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_algorithms.time_evolvers.variational.RealMcLachlanPrinciple.html">RealMcLachlanPrinciple</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_algorithms.time_evolvers.variational.ImaginaryMcLachlanPrinciple.html">ImaginaryMcLachlanPrinciple</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_algorithms.time_evolvers.variational.ForwardEulerSolver.html">ForwardEulerSolver</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../apidocs/qiskit_algorithms.AlgorithmError.html">AlgorithmError</a></li>
<li class="toctree-l2"><a class="reference internal" href="../stubs/qiskit_algorithms.AlgorithmJob.html">AlgorithmJob</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apidocs/qiskit_algorithms.utils.algorithm_globals.html">utils.algorithm_globals</a></li>
</ul>
</li>
<li class="toctree-l1 current has-children"><a class="reference internal" href="index.html">Tutorials</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" role="switch" type="checkbox"/><label for="toctree-checkbox-7"><div class="visually-hidden">Toggle navigation of Tutorials</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="01_algorithms_introduction.html">An Introduction to Algorithms using Qiskit</a></li>
<li class="toctree-l2"><a class="reference internal" href="02_vqe_advanced_options.html">Advanced VQE Options</a></li>
<li class="toctree-l2"><a class="reference internal" href="03_vqe_simulation_with_noise.html">VQE with Qiskit Aer Primitives</a></li>
<li class="toctree-l2"><a class="reference internal" href="04_vqd.html">Variational Quantum Deflation (VQD) Algorithm</a></li>
<li class="toctree-l2"><a class="reference internal" href="05_qaoa.html">Quantum Approximate Optimization Algorithm</a></li>
<li class="toctree-l2"><a class="reference internal" href="06_grover.html">Grover’s Algorithm and Amplitude Amplification</a></li>
<li class="toctree-l2"><a class="reference internal" href="07_grover_examples.html">Grover’s algorithm examples</a></li>
<li class="toctree-l2"><a class="reference internal" href="10_pvqd.html">Projected Variational Quantum Dynamics</a></li>
<li class="toctree-l2"><a class="reference internal" href="11_VarQTE.html">Variational Quantum Time Evolution</a></li>
<li class="toctree-l2"><a class="reference internal" href="12_gradients_framework.html">Gradient Framework</a></li>
<li class="toctree-l2 current current-page"><a class="current reference internal" href="#">Quantum Real Time Evolution using Trotterization</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../release_notes.html">Release Notes</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/qiskit-community/qiskit-algorithms">GitHub</a></li>
</ul>

</div></div>
      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <div class="admonition note">
<p class="admonition-title">Note</p>
<p>This page was generated from <a class="reference external" href="https://github.com/qiskit-community/qiskit-algorithms/blob/stable/0.2/docs/tutorials/13_trotterQRTE.ipynb">docs/tutorials/13_trotterQRTE.ipynb</a>.</p>
</div>
<section id="Quantum-Real-Time-Evolution-using-Trotterization">
<h1>Quantum Real Time Evolution using Trotterization<a class="headerlink" href="#Quantum-Real-Time-Evolution-using-Trotterization" title="Permalink to this heading">#</a></h1>
<p>As a real time evolution technique, the Trotterization or Trotterized Real Time Evolution (RTE) consists in the successive application of a quantum gate, assumed to approximate the time evolution of a system for a time slice [1]. Following from the Schrödinger equation, the time evolution of a system initially in the state <span class="math notranslate nohighlight">\(\vert\psi(0)\rangle\)</span> takes the form:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\vert \psi(t) \rangle = e^{-i H t} \vert \psi(0) \rangle \text{,}\]</div>
</div>
<p>where <span class="math notranslate nohighlight">\(H\)</span> is the time-independent Hamiltonian under which the system is submitted. We consider a Hamiltonian that can be written as a weighted sum of Pauli terms <span class="math notranslate nohighlight">\(H=\sum_j a_j H_j\)</span>, with <span class="math notranslate nohighlight">\(h_j\)</span> representing a tensor product of Pauli terms acting on <span class="math notranslate nohighlight">\(n\)</span> qubits. Thus, the sequence of gates that approximate a single evolution step is found under the assumption that the product of matrix exponentials is a good approximation for the sum of matrix exponentials:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\vert \psi(t) \rangle \approx \left(\prod_j e^{-i a_j H_j t/r} \right)^r \vert\psi(0) \rangle \text{,}\]</div>
</div>
<p>where <span class="math notranslate nohighlight">\(t/r\)</span> is the time slice (evolution step) that we are choosing. As a result, a gate to be applied <span class="math notranslate nohighlight">\(r\)</span> times is created. A smaller timestep leads to a more accurate approximation. However, this also leads to deeper circuits which, in practice, leads to more error accumulation, becoming a critical aspect especially on NISQ devices. For the purposes of this tutorial, all simulations are Statevector simulator, which doesn’t include any shot or hardware noise.</p>
<p>In this tutorial, we will implement real time evolutions using the <code class="docutils literal notranslate"><span class="pre">TrotterQRTE</span></code> class. To illustrate this, we will study the time evolution of the <a class="reference external" href="https://en.wikipedia.org/wiki/Ising_model">Ising model</a> on linear lattices of <span class="math notranslate nohighlight">\(L=2\)</span> and <span class="math notranslate nohighlight">\(L=6\)</span> sites. These lattices consist of an array of spins <span class="math notranslate nohighlight">\(\sigma_i\)</span> that interact only with their nearest neighbors. These spins can have two orientations: <span class="math notranslate nohighlight">\(\uparrow\)</span> and <span class="math notranslate nohighlight">\(\downarrow\)</span>, which correspond to a magnetization of
<span class="math notranslate nohighlight">\(+1\)</span> and <span class="math notranslate nohighlight">\(-1\)</span> respectively.</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[H = - J \sum_{i=0}^{L-2} \sigma_i \sigma_{i+1} - h \sum_{i=0}^{L-1} \sigma_i  \text{,}\]</div>
</div>
<p>where <span class="math notranslate nohighlight">\(J\)</span> describes the interaction energy, and <span class="math notranslate nohighlight">\(h\)</span> the magnitude of an external field. Let us write this expression using Pauli matrices, and considering that the external field has an angle <span class="math notranslate nohighlight">\(\alpha\)</span> with respect to the transversal direction,</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[H = -J \sum_{i=0}^{L-2} Z_i Z_{i+1} -h \sum_{i=0}^{L-1} (\sin\alpha Z_i + \cos\alpha X_i) \text{.}\]</div>
</div>
<p>In the computational basis, the system will be encoded as follows:</p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Quantum state</p></th>
<th class="head"><p>Spin representation</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(\lvert 0 0 0 0 \rangle\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\uparrow\uparrow\uparrow\uparrow\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(\lvert 1 0 0 0 \rangle\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\downarrow\uparrow\uparrow\uparrow\)</span></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(\ldots\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\ldots\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(\lvert 1 1 1 1 \rangle\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\downarrow\downarrow\downarrow\downarrow\)</span></p></td>
</tr>
</tbody>
</table>
</div>
<p>First, we will create a function that takes in the system parameters <span class="math notranslate nohighlight">\(L\)</span>, <span class="math notranslate nohighlight">\(J\)</span>, <span class="math notranslate nohighlight">\(h\)</span> and <span class="math notranslate nohighlight">\(\alpha\)</span>, and returns our Hamiltonian as a <code class="docutils literal notranslate"><span class="pre">SparsePauliOp</span></code>. A <a class="reference external" href="https://docs.quantum.ibm.com/api/qiskit/qiskit.quantum_info.SparsePauliOp">SparsePauliOp</a> is a sparse representation of an operator in terms of weighted <a class="reference external" href="https://docs.quantum.ibm.com/api/qiskit/qiskit.quantum_info.Pauli">Pauli</a> terms.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">qiskit.quantum_info</span> <span class="kn">import</span> <span class="n">SparsePauliOp</span>
<span class="kn">from</span> <span class="nn">math</span> <span class="kn">import</span> <span class="n">sin</span><span class="p">,</span> <span class="n">cos</span>

<span class="k">def</span> <span class="nf">get_hamiltonian</span><span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>

    <span class="c1"># List of Hamiltonian terms as 3-tuples containing</span>
    <span class="c1"># (1) the Pauli string,</span>
    <span class="c1"># (2) the qubit indices corresponding to the Pauli string,</span>
    <span class="c1"># (3) the coefficient.</span>
    <span class="n">ZZ_tuples</span> <span class="o">=</span> <span class="p">[(</span><span class="s1">&#39;ZZ&#39;</span><span class="p">,</span> <span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">],</span> <span class="o">-</span><span class="n">J</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">L</span><span class="o">-</span><span class="mi">1</span><span class="p">)]</span>
    <span class="n">Z_tuples</span> <span class="o">=</span> <span class="p">[(</span><span class="s1">&#39;Z&#39;</span><span class="p">,</span> <span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="o">-</span><span class="n">h</span> <span class="o">*</span> <span class="n">sin</span><span class="p">(</span><span class="n">alpha</span><span class="p">))</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">L</span><span class="p">)]</span>
    <span class="n">X_tuples</span> <span class="o">=</span> <span class="p">[(</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="o">-</span><span class="n">h</span> <span class="o">*</span> <span class="n">cos</span><span class="p">(</span><span class="n">alpha</span><span class="p">))</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">L</span><span class="p">)]</span>

    <span class="c1"># We create the Hamiltonian as a SparsePauliOp, via the method</span>
    <span class="c1"># `from_sparse_list`, and multiply by the interaction term.</span>
    <span class="n">hamiltonian</span> <span class="o">=</span> <span class="n">SparsePauliOp</span><span class="o">.</span><span class="n">from_sparse_list</span><span class="p">([</span><span class="o">*</span><span class="n">ZZ_tuples</span><span class="p">,</span> <span class="o">*</span><span class="n">Z_tuples</span><span class="p">,</span> <span class="o">*</span><span class="n">X_tuples</span><span class="p">],</span> <span class="n">num_qubits</span><span class="o">=</span><span class="n">L</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">hamiltonian</span><span class="o">.</span><span class="n">simplify</span><span class="p">()</span>
</pre></div>
</div>
</div>
<p>Let us get started, and create a Hamiltonian as an operator for <span class="math notranslate nohighlight">\(L=2\)</span>, and a choice of <span class="math notranslate nohighlight">\(J=0.2\)</span>, <span class="math notranslate nohighlight">\(h=1\)</span> and <span class="math notranslate nohighlight">\(\alpha=\pi/8\)</span>:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">math</span> <span class="kn">import</span> <span class="n">pi</span>

<span class="n">H</span> <span class="o">=</span> <span class="n">get_hamiltonian</span><span class="p">(</span><span class="n">L</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">J</span><span class="o">=</span><span class="mf">.2</span><span class="p">,</span> <span class="n">h</span><span class="o">=</span><span class="mf">1.</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">pi</span><span class="o">/</span><span class="mi">8</span><span class="p">)</span>
<span class="n">H</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
SparsePauliOp([&#39;ZZ&#39;, &#39;IZ&#39;, &#39;ZI&#39;, &#39;IX&#39;, &#39;XI&#39;],
              coeffs=[-0.2       +0.j, -0.38268343+0.j, -0.38268343+0.j, -0.92387953+0.j,
 -0.92387953+0.j])
</pre></div></div>
</div>
<p>Let us create an instance of <code class="docutils literal notranslate"><span class="pre">TimeEvolutionProblem</span></code>. Conceptually, it contains all the information relevant on the physical problem. In our case, we will pass it the our Hamiltonian, an initial state, a final time. As initial state, we will take a spin up and a spin down.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">qiskit.quantum_info</span> <span class="kn">import</span> <span class="n">Statevector</span>
<span class="kn">from</span> <span class="nn">qiskit_algorithms</span> <span class="kn">import</span> <span class="n">TimeEvolutionProblem</span>

<span class="n">final_time</span> <span class="o">=</span> <span class="mf">1.6</span>

<span class="c1"># First spin up, second spin down</span>
<span class="c1"># (remember that the labels are interpreted from right to left)</span>
<span class="n">initial_state</span> <span class="o">=</span> <span class="n">Statevector</span><span class="o">.</span><span class="n">from_label</span><span class="p">(</span><span class="s1">&#39;10&#39;</span><span class="p">)</span>

<span class="n">problem</span> <span class="o">=</span> <span class="n">TimeEvolutionProblem</span><span class="p">(</span><span class="n">H</span><span class="p">,</span> <span class="n">initial_state</span><span class="o">=</span><span class="n">initial_state</span><span class="p">,</span> <span class="n">time</span><span class="o">=</span><span class="n">final_time</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>We can now create an instance of <code class="docutils literal notranslate"><span class="pre">TrotterQRTE</span></code>. Conceptually, it contains the information relevant to solve a physical problem, which does by means of the method <code class="docutils literal notranslate"><span class="pre">evolve</span></code>.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">qiskit_algorithms</span> <span class="kn">import</span> <span class="n">TrotterQRTE</span>

<span class="n">trotter</span> <span class="o">=</span> <span class="n">TrotterQRTE</span><span class="p">()</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">trotter</span><span class="o">.</span><span class="n">evolve</span><span class="p">(</span><span class="n">problem</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Our evolved state is in the result’s attribute <code class="docutils literal notranslate"><span class="pre">evolved_state</span></code>, which is a <code class="docutils literal notranslate"><span class="pre">QuantumCircuit</span></code>,</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">result</span><span class="o">.</span><span class="n">evolved_state</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="s1">&#39;mpl&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/opt/hostedtoolcache/Python/3.8.18/x64/lib/python3.8/site-packages/qiskit/visualization/circuit/matplotlib.py:266: FutureWarning: The default matplotlib drawer scheme will be changed to &#34;iqp&#34; in a following release. To silence this warning, specify the current default explicitly as style=&#34;clifford&#34;, or the new default as style=&#34;iqp&#34;.
  self._style, def_font_ratio = load_style(self._style)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_13_trotterQRTE_10_1.png" src="../_images/tutorials_13_trotterQRTE_10_1.png" />
</div>
</div>
<p>By sequentially decomposing the circuit, we can show it in terms of Qiskit’s <a class="reference external" href="https://docs.quantum.ibm.com/api/qiskit/circuit_library">Circuit Library</a> standard gates.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">result</span><span class="o">.</span><span class="n">evolved_state</span><span class="o">.</span><span class="n">decompose</span><span class="p">(</span><span class="n">reps</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">decompose</span><span class="p">(</span><span class="s1">&#39;disentangler_dg&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">decompose</span><span class="p">(</span><span class="s1">&#39;multiplex1_reverse_dg&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="s1">&#39;mpl&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_13_trotterQRTE_12_0.png" src="../_images/tutorials_13_trotterQRTE_12_0.png" />
</div>
</div>
<p>The evolved state, like all <code class="docutils literal notranslate"><span class="pre">QuantumCircuit</span></code>s, can be turned into a <code class="docutils literal notranslate"><span class="pre">Statevector</span></code>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">statevector</span> <span class="o">=</span> <span class="n">Statevector</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">evolved_state</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">statevector</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Statevector([ 0.02895926+0.08738739j, -0.9411211 +0.31187756j,
              0.00811432-0.002689j  ,  0.02895926+0.08738739j],
            dims=(2, 2))
</pre></div></div>
</div>
<p>Let us find out the effect of the field direction after a certain a certain time <span class="math notranslate nohighlight">\(t=1.6\)</span>. Note that the units of time are the inverse of the units of the Hamiltonian. For the purposes of this tutorial we leave all units dimensionless.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">bar_width</span> <span class="o">=</span> <span class="mf">.1</span>
<span class="c1"># We prepare an initial state ↑↓ (01).</span>
<span class="c1"># Note that Statevector and SparsePauliOp interpret the qubits from right to left</span>
<span class="n">initial_state</span> <span class="o">=</span> <span class="n">Statevector</span><span class="o">.</span><span class="n">from_label</span><span class="p">(</span><span class="s2">&quot;10&quot;</span><span class="p">)</span>
<span class="n">trotter</span> <span class="o">=</span> <span class="n">TrotterQRTE</span><span class="p">()</span>
<span class="n">final_time</span> <span class="o">=</span> <span class="mf">1.6</span>
<span class="n">eps</span> <span class="o">=</span> <span class="mf">1e-5</span>

<span class="c1"># We create the list of angles in radians, with a small epsilon</span>
<span class="c1"># the exactly longitudinal field, which would present no dynamics at all</span>
<span class="n">alphas</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="n">eps</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span> <span class="o">-</span> <span class="n">eps</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">alpha</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">alphas</span><span class="p">):</span>
    <span class="n">H_alpha</span> <span class="o">=</span> <span class="n">get_hamiltonian</span><span class="p">(</span><span class="n">L</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">J</span><span class="o">=</span><span class="mf">.2</span><span class="p">,</span> <span class="n">h</span><span class="o">=</span><span class="mf">1.</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">)</span>
    <span class="n">problem</span> <span class="o">=</span> <span class="n">TimeEvolutionProblem</span><span class="p">(</span><span class="n">H_alpha</span><span class="p">,</span> <span class="n">initial_state</span><span class="o">=</span><span class="n">initial_state</span><span class="p">,</span> <span class="n">time</span><span class="o">=</span><span class="mf">1.6</span><span class="p">)</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">trotter</span><span class="o">.</span><span class="n">evolve</span><span class="p">(</span><span class="n">problem</span><span class="p">)</span>
    <span class="n">evolved_state</span> <span class="o">=</span> <span class="n">Statevector</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">evolved_state</span><span class="p">)</span>
    <span class="c1"># Dictionary of probabilities</span>
    <span class="n">amplitudes_dict</span> <span class="o">=</span> <span class="n">evolved_state</span><span class="o">.</span><span class="n">probabilities_dict</span><span class="p">()</span>
    <span class="n">labels</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">amplitudes_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
    <span class="n">values</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">amplitudes_dict</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
    <span class="c1"># Convert angle to degrees</span>
    <span class="n">alpha_str</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;$</span><span class="se">\\</span><span class="s2">alpha=</span><span class="si">{</span><span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">alpha</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">180</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">pi</span><span class="p">))</span><span class="si">}</span><span class="s2">^</span><span class="se">\\</span><span class="s2">circ$&quot;</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">+</span> <span class="n">i</span> <span class="o">*</span> <span class="n">bar_width</span><span class="p">,</span> <span class="n">values</span><span class="p">,</span> <span class="n">bar_width</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">alpha_str</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">.7</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">bar_width</span><span class="p">,</span> <span class="n">labels</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Measurement&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Probability&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot;Measurement probabilities at $t=</span><span class="si">{</span><span class="n">final_time</span><span class="si">}</span><span class="s2">$, for various field angles $</span><span class="se">\\</span><span class="s2">alpha$</span><span class="se">\n</span><span class="s2">&quot;</span>
    <span class="sa">f</span><span class="s2">&quot;Initial state: 10, Linear lattice of size $L=2$&quot;</span>
<span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;matplotlib.legend.Legend at 0x7f61c1527c70&gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_13_trotterQRTE_16_1.png" src="../_images/tutorials_13_trotterQRTE_16_1.png" />
</div>
</div>
<p>We have prepared a system initially with a sequence of spins <span class="math notranslate nohighlight">\(\uparrow\downarrow\)</span>, which corresponds to <span class="math notranslate nohighlight">\(\vert\psi(0)\rangle = \vert01\rangle\)</span>. After letting it evolve for <span class="math notranslate nohighlight">\(t=1.6\)</span> under a transversal field (<span class="math notranslate nohighlight">\(\alpha=0^\circ\)</span>), we are almost guaranteed to measure <span class="math notranslate nohighlight">\(\downarrow\uparrow\)</span>, i.e. have a spin swap. (Note that the labels are interpreted from right to left). If the field is longitudinal (<span class="math notranslate nohighlight">\(\alpha=\pm90^\circ\)</span>), we will have no evolution, therefore we will
measure the system as it was initially prepared, <span class="math notranslate nohighlight">\(\uparrow\downarrow\)</span>. With intermediate angles, at <span class="math notranslate nohighlight">\(\alpha=\pm45^\circ\)</span>, we will be able to measure all combinations will different probabilities, being a spin swap the most likely with a probability of 67%.</p>
<section id="Auxiliary-operators">
<h2>Auxiliary operators<a class="headerlink" href="#Auxiliary-operators" title="Permalink to this heading">#</a></h2>
<p>Let us look into another feature of <code class="docutils literal notranslate"><span class="pre">TrotterQRTE</span></code>. We will now explore its ability to perform time evolutions of a system, while keeping track of some observables. The system that we now consider has a size of <span class="math notranslate nohighlight">\(L=6\)</span>.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">math</span> <span class="kn">import</span> <span class="n">pi</span>

<span class="n">L</span> <span class="o">=</span> <span class="mi">6</span>
<span class="n">H</span> <span class="o">=</span> <span class="n">get_hamiltonian</span><span class="p">(</span><span class="n">L</span><span class="o">=</span><span class="n">L</span><span class="p">,</span> <span class="n">J</span><span class="o">=</span><span class="mf">.2</span><span class="p">,</span> <span class="n">h</span><span class="o">=</span><span class="mf">1.2</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">pi</span><span class="o">/</span><span class="mi">8</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">TrotterQRTE</span></code> instance now will be created with a <code class="docutils literal notranslate"><span class="pre">num_timesteps</span></code> argument, and an <code class="docutils literal notranslate"><span class="pre">Estimator</span></code> primitive. The Qiskit’s <code class="docutils literal notranslate"><span class="pre">Estimator</span></code> primitive estimates expectation values of observables, <span class="math notranslate nohighlight">\(\langle\psi\vert\hat{O}\vert\psi\rangle\)</span>.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">qiskit_algorithms</span> <span class="kn">import</span> <span class="n">TrotterQRTE</span>
<span class="kn">from</span> <span class="nn">qiskit.primitives</span> <span class="kn">import</span> <span class="n">Estimator</span>

<span class="n">num_timesteps</span> <span class="o">=</span> <span class="mi">60</span>
<span class="n">trotter</span> <span class="o">=</span> <span class="n">TrotterQRTE</span><span class="p">(</span><span class="n">num_timesteps</span><span class="o">=</span><span class="n">num_timesteps</span><span class="p">,</span> <span class="n">estimator</span><span class="o">=</span><span class="n">Estimator</span><span class="p">())</span>
</pre></div>
</div>
</div>
<p>Let us define a <em>magnetization operator</em> <span class="math notranslate nohighlight">\(\sum_i Z_i\)</span>, and a <em>mean spin correlation operator</em> <span class="math notranslate nohighlight">\(\sum_i Z_i Z_{i+1} / (L - 1)\)</span>.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">magnetization_op</span> <span class="o">=</span> <span class="n">SparsePauliOp</span><span class="o">.</span><span class="n">from_sparse_list</span><span class="p">([(</span><span class="s1">&#39;Z&#39;</span><span class="p">,</span> <span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="mf">1.</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">L</span><span class="p">)],</span> <span class="n">num_qubits</span><span class="o">=</span><span class="n">L</span><span class="p">)</span>
<span class="n">correlation_op</span> <span class="o">=</span> <span class="n">SparsePauliOp</span><span class="o">.</span><span class="n">from_sparse_list</span><span class="p">([(</span><span class="s1">&#39;ZZ&#39;</span><span class="p">,</span> <span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">],</span> <span class="mf">1.</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">L</span><span class="o">-</span><span class="mi">1</span><span class="p">)],</span> <span class="n">num_qubits</span><span class="o">=</span><span class="n">L</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">L</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Our new initial state will have the two middle spins facing down, and the <code class="docutils literal notranslate"><span class="pre">TimeEvolutionProblem</span></code> will incorporate some observables that will be kept track of: 1. the energy, i.e. the expectation value of the Hamiltonian, <span class="math notranslate nohighlight">\(\langle H\rangle\)</span> 2. the magnetization, <span class="math notranslate nohighlight">\(\langle \sum_i Z_i \rangle\)</span> 3. the mean spin correlation, <span class="math notranslate nohighlight">\(\langle\sum_i Z_i Z_{i+1}\rangle/(L-1)\)</span></p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">final_time</span> <span class="o">=</span> <span class="mf">30.</span>
<span class="n">initial_state</span> <span class="o">=</span> <span class="n">Statevector</span><span class="o">.</span><span class="n">from_label</span><span class="p">(</span><span class="s1">&#39;001100&#39;</span><span class="p">)</span>
<span class="n">problem</span> <span class="o">=</span> <span class="n">TimeEvolutionProblem</span><span class="p">(</span><span class="n">H</span><span class="p">,</span> <span class="n">initial_state</span><span class="o">=</span><span class="n">initial_state</span><span class="p">,</span> <span class="n">time</span><span class="o">=</span><span class="n">final_time</span><span class="p">,</span> <span class="n">aux_operators</span><span class="o">=</span><span class="p">[</span><span class="n">H</span><span class="p">,</span> <span class="n">magnetization_op</span><span class="p">,</span> <span class="n">correlation_op</span><span class="p">])</span>
</pre></div>
</div>
</div>
<p>Again, we let our <code class="docutils literal notranslate"><span class="pre">TrotterQRTE</span></code> evolve our newly created problem instance.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">result</span> <span class="o">=</span> <span class="n">trotter</span><span class="o">.</span><span class="n">evolve</span><span class="p">(</span><span class="n">problem</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>The new result also features an <code class="docutils literal notranslate"><span class="pre">observables</span></code> attribute. Let’s extract the observables stored in it.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">observables</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">observables</span><span class="p">)[:,</span> <span class="p">:,</span> <span class="mi">0</span><span class="p">])</span>
<span class="n">observables</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(61, 3)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">times</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">final_time</span><span class="p">,</span> <span class="n">num_timesteps</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="c1"># includes initial state</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">times</span><span class="p">,</span> <span class="n">observables</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;First order&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;darkmagenta&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">.8</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">times</span><span class="p">,</span> <span class="n">observables</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;First order&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;darkmagenta&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">.8</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">times</span><span class="p">,</span> <span class="n">observables</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;First order&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;darkmagenta&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">.8</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Energy&quot;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Magnetization&quot;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Mean spin correlation&quot;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Time&quot;</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s2">&quot;Observable evolution&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Text(0.5, 0.98, &#39;Observable evolution&#39;)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_13_trotterQRTE_31_1.png" src="../_images/tutorials_13_trotterQRTE_31_1.png" />
</div>
</div>
<p>Let us verify these results by comparing these expected values using Trotter evolution with the exact ones. To that end, we evaluate directly the expression discussed in the introduction,</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\vert \psi(t) \rangle = e^{-i H t} \vert \psi(0) \rangle \text{,}\]</div>
</div>
<p>on each one of the timesteps used by Trotter. We compute this exponential using SciPy’s <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.linalg.expm.html">linalg.expm</a> function, and then we let the initial system evolve using the <code class="docutils literal notranslate"><span class="pre">Statevector</span></code>’s <a class="reference external" href="https://docs.quantum.ibm.com/api/qiskit/qiskit.quantum_info.Statevector#evolve">evolve</a> method. This becomes too costly to be performed on larger systems very quickly.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">scipy</span> <span class="k">as</span> <span class="nn">sc</span>

<span class="n">H_array</span> <span class="o">=</span> <span class="n">H</span><span class="o">.</span><span class="n">to_matrix</span><span class="p">()</span>

<span class="c1"># We define a slightly denser time mesh</span>
<span class="n">exact_times</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">final_time</span><span class="p">,</span> <span class="mi">101</span><span class="p">)</span>

<span class="c1"># We compute the exact evolution using the exp</span>
<span class="n">exact_evolution</span> <span class="o">=</span> <span class="p">[</span><span class="n">initial_state</span><span class="o">.</span><span class="n">evolve</span><span class="p">(</span><span class="n">sc</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">expm</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">time</span> <span class="o">*</span> <span class="n">H_array</span><span class="p">))</span> <span class="k">for</span> <span class="n">time</span> <span class="ow">in</span> <span class="n">exact_times</span><span class="p">]</span>
</pre></div>
</div>
</div>
<p>Having the exact state vectors, we compute the exact evolution of our operators’ expectation values.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">exact_energy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">([</span><span class="n">sv</span><span class="o">.</span><span class="n">expectation_value</span><span class="p">(</span><span class="n">H</span><span class="p">)</span> <span class="k">for</span> <span class="n">sv</span> <span class="ow">in</span> <span class="n">exact_evolution</span><span class="p">])</span>
<span class="n">exact_magnetization</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">([</span><span class="n">sv</span><span class="o">.</span><span class="n">expectation_value</span><span class="p">(</span><span class="n">magnetization_op</span><span class="p">)</span> <span class="k">for</span> <span class="n">sv</span> <span class="ow">in</span> <span class="n">exact_evolution</span><span class="p">])</span>
<span class="n">exact_correlation</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">([</span><span class="n">sv</span><span class="o">.</span><span class="n">expectation_value</span><span class="p">(</span><span class="n">correlation_op</span><span class="p">)</span> <span class="k">for</span> <span class="n">sv</span> <span class="ow">in</span> <span class="n">exact_evolution</span><span class="p">])</span>
</pre></div>
</div>
</div>
<p>We incorporate the exact evolution of the operators alongside the expected values resulting from the Trotterization.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">exact_times</span><span class="p">,</span> <span class="n">exact_energy</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Exact&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">exact_times</span><span class="p">,</span> <span class="n">exact_magnetization</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Exact&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">exact_times</span><span class="p">,</span> <span class="n">exact_correlation</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Exact&#39;</span><span class="p">)</span>
<span class="c1"># Select the labels of only the first axis</span>
<span class="n">legend</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="o">*</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">get_legend_handles_labels</span><span class="p">(),</span> <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">.5</span><span class="p">),</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;center left&#39;</span><span class="p">,</span> <span class="n">framealpha</span><span class="o">=</span><span class="mf">.5</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">fig</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_13_trotterQRTE_37_0.png" src="../_images/tutorials_13_trotterQRTE_37_0.png" />
</div>
</div>
<p>We see that, as an approximation, a Pauli-Trotter evolution isn’t too far from the exact solution, but the accuracy is limited. Let’s see how to find higher order formulas to address this.</p>
</section>
<section id="Product-formula-overview">
<h2>Product formula overview<a class="headerlink" href="#Product-formula-overview" title="Permalink to this heading">#</a></h2>
<p>If it isn’t specified, the default product formula that <code class="docutils literal notranslate"><span class="pre">TrotterQRTE</span></code> uses is the Lie product formula [2], which is at first order. In Qiskit this is implemented in the <a class="reference external" href="https://docs.quantum.ibm.com/api/qiskit/qiskit.synthesis.LieTrotter">LieTrotter</a> class. A first order formula consists of the approximation stated in the introduction, where the matrix exponential of a sum is approximated by a product of matrix exponentials:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[e^{A+B} \approx e^A e^B\]</div>
</div>
<p>Knowing this, we can have a look at the circuit that performs a single Trotter step.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">qiskit.circuit</span> <span class="kn">import</span> <span class="n">QuantumCircuit</span>
<span class="kn">from</span> <span class="nn">qiskit.circuit.library</span> <span class="kn">import</span> <span class="n">PauliEvolutionGate</span>
<span class="kn">from</span> <span class="nn">qiskit.synthesis</span> <span class="kn">import</span> <span class="n">LieTrotter</span>

<span class="n">dt</span> <span class="o">=</span> <span class="n">final_time</span> <span class="o">/</span> <span class="n">num_timesteps</span>
<span class="n">trotter_step_first_order</span> <span class="o">=</span> <span class="n">PauliEvolutionGate</span><span class="p">(</span><span class="n">H</span><span class="p">,</span> <span class="n">dt</span><span class="p">,</span> <span class="n">synthesis</span><span class="o">=</span><span class="n">LieTrotter</span><span class="p">())</span>

<span class="c1"># We create an empty circuit</span>
<span class="n">circuit</span> <span class="o">=</span> <span class="n">QuantumCircuit</span><span class="p">(</span><span class="n">H</span><span class="o">.</span><span class="n">num_qubits</span><span class="p">)</span>
<span class="n">circuit</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">trotter_step_first_order</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="n">H</span><span class="o">.</span><span class="n">num_qubits</span><span class="p">))</span>
<span class="n">circuit</span> <span class="o">=</span> <span class="n">circuit</span><span class="o">.</span><span class="n">decompose</span><span class="p">(</span><span class="n">reps</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="c1"># Let us print some stats</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">Trotter step with Lie-Trotter</span>
<span class="s2">-----------------------------</span>

<span class="s2">                  Depth: </span><span class="si">{</span><span class="n">circuit</span><span class="o">.</span><span class="n">depth</span><span class="p">()</span><span class="si">}</span>
<span class="s2">             Gate count: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">circuit</span><span class="p">)</span><span class="si">}</span>
<span class="s2">    Nonlocal gate count: </span><span class="si">{</span><span class="n">circuit</span><span class="o">.</span><span class="n">num_nonlocal_gates</span><span class="p">()</span><span class="si">}</span>
<span class="s2">         Gate breakdown: </span><span class="si">{</span><span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">k</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">v</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="n">v</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">circuit</span><span class="o">.</span><span class="n">count_ops</span><span class="p">()</span><span class="o">.</span><span class="n">items</span><span class="p">()])</span><span class="si">}</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">)</span>

<span class="c1"># And finally draw the circuit</span>
<span class="n">circuit</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="s1">&#39;mpl&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

Trotter step with Lie-Trotter
-----------------------------

                  Depth: 7
             Gate count: 17
    Nonlocal gate count: 5
         Gate breakdown: RZ: 6, RX: 6, RZZ: 5

</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_13_trotterQRTE_41_1.png" src="../_images/tutorials_13_trotterQRTE_41_1.png" />
</div>
</div>
<p>There exists a second-order formula, called the Suzuki-Trotter decomposition [3], and can be used in Qiskit by means of the <a class="reference external" href="https://docs.quantum.ibm.com/api/qiskit/qiskit.synthesis.SuzukiTrotter">SuzukiTrotter class</a>. Using this formula, a second order decomposition is:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[e^{A+B} \approx e^{B/2}e^{A}e^{B/2}\]</div>
</div>
<p>By means of recursions, higher-order approximations can be found [1].</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">qiskit.synthesis</span> <span class="kn">import</span> <span class="n">SuzukiTrotter</span>

<span class="n">second_order_formula</span> <span class="o">=</span> <span class="n">SuzukiTrotter</span><span class="p">()</span> <span class="c1"># if not passed, order defaults to 2</span>
<span class="n">trotter_step_second_order</span> <span class="o">=</span> <span class="n">PauliEvolutionGate</span><span class="p">(</span><span class="n">H</span><span class="p">,</span> <span class="n">dt</span><span class="p">,</span> <span class="n">synthesis</span><span class="o">=</span><span class="n">second_order_formula</span><span class="p">)</span>
<span class="n">circuit</span> <span class="o">=</span> <span class="n">QuantumCircuit</span><span class="p">(</span><span class="n">H</span><span class="o">.</span><span class="n">num_qubits</span><span class="p">)</span>
<span class="n">circuit</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">trotter_step_second_order</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="n">H</span><span class="o">.</span><span class="n">num_qubits</span><span class="p">))</span>
<span class="n">circuit</span> <span class="o">=</span> <span class="n">circuit</span><span class="o">.</span><span class="n">decompose</span><span class="p">(</span><span class="n">reps</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="c1"># Let us print some stats</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">Trotter step with Suzuki Trotter (2nd order)</span>
<span class="s2">--------------------------------------------</span>

<span class="s2">                  Depth: </span><span class="si">{</span><span class="n">circuit</span><span class="o">.</span><span class="n">depth</span><span class="p">()</span><span class="si">}</span>
<span class="s2">             Gate count: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">circuit</span><span class="p">)</span><span class="si">}</span>
<span class="s2">    Nonlocal gate count: </span><span class="si">{</span><span class="n">circuit</span><span class="o">.</span><span class="n">num_nonlocal_gates</span><span class="p">()</span><span class="si">}</span>
<span class="s2">         Gate breakdown: </span><span class="si">{</span><span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">k</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">v</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="n">v</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">circuit</span><span class="o">.</span><span class="n">count_ops</span><span class="p">()</span><span class="o">.</span><span class="n">items</span><span class="p">()])</span><span class="si">}</span>

<span class="s2">&quot;&quot;&quot;</span><span class="p">)</span>

<span class="c1"># And finall</span>
<span class="n">circuit</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="s1">&#39;mpl&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

Trotter step with Suzuki Trotter (2nd order)
--------------------------------------------

                  Depth: 14
             Gate count: 33
    Nonlocal gate count: 10
         Gate breakdown: RZ: 12, RX: 11, RZZ: 10


</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_13_trotterQRTE_43_1.png" src="../_images/tutorials_13_trotterQRTE_43_1.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fourth_order_formula</span> <span class="o">=</span> <span class="n">SuzukiTrotter</span><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="n">trotter_step_fourth_order</span> <span class="o">=</span> <span class="n">PauliEvolutionGate</span><span class="p">(</span><span class="n">H</span><span class="p">,</span> <span class="n">dt</span><span class="p">,</span> <span class="n">synthesis</span><span class="o">=</span><span class="n">fourth_order_formula</span><span class="p">)</span>
<span class="n">circuit</span> <span class="o">=</span> <span class="n">QuantumCircuit</span><span class="p">(</span><span class="n">H</span><span class="o">.</span><span class="n">num_qubits</span><span class="p">)</span>
<span class="n">circuit</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">trotter_step_fourth_order</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="n">H</span><span class="o">.</span><span class="n">num_qubits</span><span class="p">))</span>
<span class="n">circuit</span> <span class="o">=</span> <span class="n">circuit</span><span class="o">.</span><span class="n">decompose</span><span class="p">(</span><span class="n">reps</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="c1"># Let us print some stats</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">Trotter step with Suzuki Trotter (4th order)</span>
<span class="s2">--------------------------------------------</span>

<span class="s2">                  Depth: </span><span class="si">{</span><span class="n">circuit</span><span class="o">.</span><span class="n">depth</span><span class="p">()</span><span class="si">}</span>
<span class="s2">             Gate count: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">circuit</span><span class="p">)</span><span class="si">}</span>
<span class="s2">    Nonlocal gate count: </span><span class="si">{</span><span class="n">circuit</span><span class="o">.</span><span class="n">num_nonlocal_gates</span><span class="p">()</span><span class="si">}</span>
<span class="s2">         Gate breakdown: </span><span class="si">{</span><span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">k</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">v</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="n">v</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">circuit</span><span class="o">.</span><span class="n">count_ops</span><span class="p">()</span><span class="o">.</span><span class="n">items</span><span class="p">()])</span><span class="si">}</span>

<span class="s2">&quot;&quot;&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

Trotter step with Suzuki Trotter (4th order)
--------------------------------------------

                  Depth: 70
             Gate count: 165
    Nonlocal gate count: 50
         Gate breakdown: RZ: 60, RX: 55, RZZ: 50


</pre></div></div>
</div>
<p>Finally, let us perform a simulation at fourth order.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">qiskit.synthesis</span> <span class="kn">import</span> <span class="n">SuzukiTrotter</span>

<span class="n">trotter</span> <span class="o">=</span> <span class="n">TrotterQRTE</span><span class="p">(</span><span class="n">SuzukiTrotter</span><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="mi">4</span><span class="p">),</span> <span class="n">num_timesteps</span><span class="o">=</span><span class="n">num_timesteps</span><span class="p">,</span> <span class="n">estimator</span><span class="o">=</span><span class="n">Estimator</span><span class="p">())</span>
<span class="n">problem</span> <span class="o">=</span> <span class="n">TimeEvolutionProblem</span><span class="p">(</span><span class="n">H</span><span class="p">,</span> <span class="n">initial_state</span><span class="o">=</span><span class="n">initial_state</span><span class="p">,</span> <span class="n">time</span><span class="o">=</span><span class="n">final_time</span><span class="p">,</span> <span class="n">aux_operators</span><span class="o">=</span><span class="p">[</span><span class="n">H</span><span class="p">,</span> <span class="n">magnetization_op</span><span class="p">,</span> <span class="n">correlation_op</span><span class="p">])</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">trotter</span><span class="o">.</span><span class="n">evolve</span><span class="p">(</span><span class="n">problem</span><span class="p">)</span>
<span class="n">observables_order4</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">observables</span><span class="p">)[:,</span> <span class="p">:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>and plot the results.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">times</span><span class="p">,</span> <span class="n">observables_order4</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Fourth Order&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;limegreen&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">.8</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">times</span><span class="p">,</span> <span class="n">observables_order4</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Fourth Order&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;limegreen&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">.8</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">times</span><span class="p">,</span> <span class="n">observables_order4</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Fourth Order&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;limegreen&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">.8</span><span class="p">)</span>

<span class="c1"># Replace the legend</span>
<span class="n">legend</span><span class="o">.</span><span class="n">remove</span><span class="p">()</span>
<span class="n">legend</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="o">*</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">get_legend_handles_labels</span><span class="p">(),</span> <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">.5</span><span class="p">),</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;center left&#39;</span><span class="p">,</span> <span class="n">framealpha</span><span class="o">=</span><span class="mf">.5</span><span class="p">)</span>
<span class="n">fig</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_13_trotterQRTE_48_0.png" src="../_images/tutorials_13_trotterQRTE_48_0.png" />
</div>
</div>
<p>As it is to expect, we can directly see that a higher-order product formula leads to more accurate expectation values.</p>
</section>
<section id="Magnetization-evolution-plot">
<h2>Magnetization evolution plot<a class="headerlink" href="#Magnetization-evolution-plot" title="Permalink to this heading">#</a></h2>
<p>In this last step, we aim at visualizing the time evolution of each one of the sites of the lattice individually. Let us present the expected value of the magnetization of each one of the sites as a function of time in a color plot. As the initial state was <span class="math notranslate nohighlight">\(\vert\psi(0)\rangle = \vert001100\rangle\)</span> (spin sequence <span class="math notranslate nohighlight">\(\uparrow\uparrow\downarrow\downarrow\uparrow\uparrow\)</span>), at time <span class="math notranslate nohighlight">\(t=0\)</span> we expect to see magnetization <span class="math notranslate nohighlight">\(-1\)</span> in the two middle signs and <span class="math notranslate nohighlight">\(+1\)</span> elsewhere.
During the evolution, as the plot above suggests, we can expect to see oscillations which will eventually damp.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">cm</span>

<span class="c1"># An inner list comprehension loops over the terms of the SparsePauliOp magnetization_op,</span>
<span class="c1"># which corresponds to the magnetization of each one of the sites</span>
<span class="n">magnetizations</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">([[</span><span class="n">sv</span><span class="o">.</span><span class="n">expectation_value</span><span class="p">(</span><span class="n">term</span><span class="p">)</span> <span class="k">for</span> <span class="n">term</span> <span class="ow">in</span> <span class="n">magnetization_op</span><span class="p">]</span> <span class="k">for</span> <span class="n">sv</span> <span class="ow">in</span> <span class="n">exact_evolution</span><span class="p">])</span>
<span class="c1"># The shape of magnetizations is (101, 6), containing &lt;Z&gt;(t) for each site 0, 1, ..., 5</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="c1"># Create the 2-dim xx and yy arrays tiling the grid with the x and y values</span>
<span class="n">xx</span><span class="p">,</span> <span class="n">yy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">exact_times</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">L</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">pcolor</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span> <span class="n">yy</span><span class="p">,</span> <span class="n">magnetizations</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=+</span><span class="mi">1</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;RdBu&#39;</span><span class="p">)</span>
<span class="c1"># Force the figure to have all y ticks from 0 to 5</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">L</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Site $i$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;$</span><span class="se">\\</span><span class="s1">langle Z_i </span><span class="se">\\</span><span class="s1">rangle$&#39;</span><span class="p">,</span> <span class="n">aspect</span><span class="o">=</span><span class="mf">1.8</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;matplotlib.colorbar.Colorbar at 0x7f61c0240af0&gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_13_trotterQRTE_51_1.png" src="../_images/tutorials_13_trotterQRTE_51_1.png" />
</div>
</div>
<section id="References">
<h3>References<a class="headerlink" href="#References" title="Permalink to this heading">#</a></h3>
<p>[1] Hatano, Naomichi, and Masuo Suzuki. “Finding exponential product formulas of higher orders.” <em>Quantum annealing and other optimization methods.</em> Berlin, Heidelberg: Springer Berlin Heidelberg, 2005. 37-68.</p>
<p>[2] Varadarajan, Veeravalli S. <em>Lie groups, Lie algebras, and their representations.</em> Vol. 102. Springer Science &amp; Business Media, 2013.</p>
<p>[3] Magnus, Wilhelm. “On the exponential solution of differential equations for a linear operator.” <em>Communications on pure and applied mathematics</em> 7.4 (1954): 649-673.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">qiskit.tools.jupyter</span>
<span class="o">%</span><span class="k">qiskit_version_table</span>
<span class="o">%</span><span class="k">qiskit_copyright</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/tmp/ipykernel_28401/1894253813.py:1: DeprecationWarning: qiskit.tools.jupyter is deprecated and will be removed in Qiskit 1.0.0
  import qiskit.tools.jupyter
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<h3>Version Information</h3><table><tr><th>Software</th><th>Version</th></tr><tr><td><code>qiskit</code></td><td>0.46.0</td></tr><tr><td><code>qiskit_algorithms</code></td><td>0.2.2</td></tr><tr><th colspan='2'>System information</th></tr><tr><td>Python version</td><td>3.8.18</td></tr><tr><td>Python compiler</td><td>GCC 11.4.0</td></tr><tr><td>Python build</td><td>default, Aug 28 2023 08:27:22</td></tr><tr><td>OS</td><td>Linux</td></tr><tr><td>CPUs</td><td>2</td></tr><tr><td>Memory (Gb)</td><td>15.60690689086914</td></tr><tr><td colspan='2'>Tue Feb 13 19:55:01 2024 UTC</td></tr></table></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<div style='width: 100%; background-color:#d5d9e0;padding-left: 10px; padding-bottom: 10px; padding-right: 10px; padding-top: 5px'><h3>This code is a part of Qiskit</h3><p>&copy; Copyright IBM 2017, 2024.</p><p>This code is licensed under the Apache License, Version 2.0. You may<br>obtain a copy of this license in the LICENSE.txt file in the root directory<br> of this source tree or at http://www.apache.org/licenses/LICENSE-2.0.<p>Any modifications or derivative works of this code must retain this<br>copyright notice, and modified files need to carry a notice indicating<br>that they have been altered from the originals.</p></div></div>
</div>
<script type="application/vnd.jupyter.widget-state+json">
{"state": {"599063b19f2a4d91be2ff3143bf6ad79": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": "0px 0px 10px 0px", "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "a12844a6c73d4a47bc43f8ffa55c615c": {"model_name": "HTMLStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "background": null, "description_width": "", "font_size": null, "text_color": null}}, "c537f99c79be4dadbeb02d20c8f897a8": {"model_name": "HTMLModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HTMLView", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_599063b19f2a4d91be2ff3143bf6ad79", "placeholder": "\u200b", "style": "IPY_MODEL_a12844a6c73d4a47bc43f8ffa55c615c", "tabbable": null, "tooltip": null, "value": "<p style='font-family: IBM Plex Sans, Arial, Helvetica, sans-serif; font-size: 20px; font-weight: medium;'>Circuit Properties</p>"}}}, "version_major": 2, "version_minor": 0}
</script></section>
</section>
</section>

        </article>
      </div>
      <footer>
        <div class="related-pages">
          <a class="next-page" href="../release_notes.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Release Notes</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="12_gradients_framework.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Gradient Framework</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2017-2024, Qiskit Algorithms Development Team
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            <div class="last-updated">
              Last updated on 2024/02/13</div>
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Quantum Real Time Evolution using Trotterization</a><ul>
<li><a class="reference internal" href="#Auxiliary-operators">Auxiliary operators</a></li>
<li><a class="reference internal" href="#Product-formula-overview">Product formula overview</a></li>
<li><a class="reference internal" href="#Magnetization-evolution-plot">Magnetization evolution plot</a><ul>
<li><a class="reference internal" href="#References">References</a></li>
</ul>
</li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="../_static/jquery.js?v=5d32c60e"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js?v=227644f7"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=4825356b"></script>
    <script src="../_static/scripts/qiskit-sphinx-theme.js?v=4d77b8ca"></script>
    <script src="../_static/design-tabs.js?v=36754332"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    </body>
</html>