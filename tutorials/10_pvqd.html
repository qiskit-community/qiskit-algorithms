<!doctype html>
<html class="no-js" lang="en">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="../genindex.html" /><link rel="search" title="Search" href="../search.html" /><link rel="next" title="Variational Quantum Time Evolution" href="11_VarQTE.html" /><link rel="prev" title="Grover’s algorithm examples" href="07_grover_examples.html" />

    <!-- Generated with Sphinx 7.4.7 and Furo 2024.01.29 -->
        <title>Projected Variational Quantum Dynamics - Qiskit Algorithms 0.4.0</title>
      <link rel="stylesheet" type="text/css" href="../_static/styles/furo.css?v=135e06be" />
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=3ee1c6c6" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/qiskit-sphinx-theme.css?v=fe84956c" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/qiskit-ecosystem.css?v=745c5aa7" />
    <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo-extensions.css?v=36a5483c" />
    <link rel="stylesheet" type="text/css" href="../_static/nbsphinx-gallery.css?v=26227f6e" />
    
    


<style>
  body {
    --color-code-background: #ffffff;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style><link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Mono:wght@400;600&family=IBM+Plex+Sans:ital,wght@0,400;0,600;1,400;1,600&display=swap" rel="stylesheet">
<script src="../_static/js/web-components/top-nav-bar.js"></script></head>
  <body>
    
    <script>document.body.dataset.theme = "light";</script>
    
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg id="icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32">
      <defs><style>.cls-1{fill:none;}</style></defs>
      <path d="M28,4H4A2,2,0,0,0,2,6V26a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V6A2,2,0,0,0,28,4ZM4,6H20V26H4ZM28,26H22V6h6Z"/>
      <rect id="_Transparent_Rectangle_" data-name="&lt;Transparent Rectangle&gt;" class="cls-1" width="32" height="32"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg id="icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32">
      <defs><style>.cls-1{fill:none;}</style></defs>
      <rect x="4" y="6" width="24" height="2"/>
      <rect x="4" y="24" width="24" height="2"/>
      <rect x="4" y="12" width="24" height="2"/>
      <rect x="4" y="18" width="24" height="2"/>
      <rect id="_Transparent_Rectangle_" data-name="&lt;Transparent Rectangle&gt;" class="cls-1" width="32" height="32"/>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg version="1.1" id="icon" xmlns="http://www.w3.org/2000/svg" x="0px" y="0px"
         viewBox="0 0 32 32" style="enable-background:new 0 0 32 32;" xml:space="preserve"><polygon points="22,16 12,26 10.6,24.6 19.2,16 10.6,7.4 12,6 " stroke="currentColor"/>
      <rect id="_x3C_Transparent_Rectangle_x3E_" fill="none" width="32" height="32"/>
    </svg>
  </symbol>
  <symbol id="svg-new-tab" viewBox="0 0 32 32">
    <svg id="icon" xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 32 32">
      <defs>
        <style>
          .cls-1 {
            fill: none;
          }
        </style>
      </defs>
      <path fill="#6929C4" d="M26,28H6a2.0027,2.0027,0,0,1-2-2V6A2.0027,2.0027,0,0,1,6,4H16V6H6V26H26V16h2V26A2.0027,2.0027,0,0,1,26,28Z"/>
      <polygon fill="#6929C4" points="20 2 20 4 26.586 4 18 12.586 19.414 14 28 5.414 28 12 30 12 30 2 20 2"/>
      <rect id="_Transparent_Rectangle_" data-name="&lt;Transparent Rectangle&gt;" class="cls-1" width="32" height="32"/>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../index.html"><div class="brand">Qiskit Algorithms 0.4.0</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><div class="sidebar-brand">
  <a href="https://www.qiskit.org/ecosystem">
    <div class="sidebar-logo-container">
      <img class="sidebar-logo" src="../_static/images/ecosystem-logo.svg" alt="Qiskit Ecosystem logo"/>
    </div>
  </a>
  
  <span class="sidebar-brand-text">Qiskit Algorithms 0.4.0</span>
</div><form class="sidebar-search-container" method="get" action="../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../index.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting_started.html">Getting Started</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../apidocs/qiskit_algorithms.html">API References</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of API References</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../stubs/qiskit_algorithms.AmplificationProblem.html">AmplificationProblem</a></li>
<li class="toctree-l2"><a class="reference internal" href="../stubs/qiskit_algorithms.AmplitudeAmplifier.html">AmplitudeAmplifier</a></li>
<li class="toctree-l2"><a class="reference internal" href="../stubs/qiskit_algorithms.Grover.html">Grover</a></li>
<li class="toctree-l2"><a class="reference internal" href="../stubs/qiskit_algorithms.GroverResult.html">GroverResult</a></li>
<li class="toctree-l2"><a class="reference internal" href="../stubs/qiskit_algorithms.AmplitudeEstimator.html">AmplitudeEstimator</a></li>
<li class="toctree-l2"><a class="reference internal" href="../stubs/qiskit_algorithms.AmplitudeEstimatorResult.html">AmplitudeEstimatorResult</a></li>
<li class="toctree-l2"><a class="reference internal" href="../stubs/qiskit_algorithms.AmplitudeEstimation.html">AmplitudeEstimation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../stubs/qiskit_algorithms.AmplitudeEstimationResult.html">AmplitudeEstimationResult</a></li>
<li class="toctree-l2"><a class="reference internal" href="../stubs/qiskit_algorithms.EstimationProblem.html">EstimationProblem</a></li>
<li class="toctree-l2"><a class="reference internal" href="../stubs/qiskit_algorithms.FasterAmplitudeEstimation.html">FasterAmplitudeEstimation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../stubs/qiskit_algorithms.FasterAmplitudeEstimationResult.html">FasterAmplitudeEstimationResult</a></li>
<li class="toctree-l2"><a class="reference internal" href="../stubs/qiskit_algorithms.IterativeAmplitudeEstimation.html">IterativeAmplitudeEstimation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../stubs/qiskit_algorithms.IterativeAmplitudeEstimationResult.html">IterativeAmplitudeEstimationResult</a></li>
<li class="toctree-l2"><a class="reference internal" href="../stubs/qiskit_algorithms.MaximumLikelihoodAmplitudeEstimation.html">MaximumLikelihoodAmplitudeEstimation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../stubs/qiskit_algorithms.MaximumLikelihoodAmplitudeEstimationResult.html">MaximumLikelihoodAmplitudeEstimationResult</a></li>
<li class="toctree-l2"><a class="reference internal" href="../stubs/qiskit_algorithms.Eigensolver.html">Eigensolver</a></li>
<li class="toctree-l2"><a class="reference internal" href="../stubs/qiskit_algorithms.EigensolverResult.html">EigensolverResult</a></li>
<li class="toctree-l2"><a class="reference internal" href="../stubs/qiskit_algorithms.NumPyEigensolver.html">NumPyEigensolver</a></li>
<li class="toctree-l2"><a class="reference internal" href="../stubs/qiskit_algorithms.NumPyEigensolverResult.html">NumPyEigensolverResult</a></li>
<li class="toctree-l2"><a class="reference internal" href="../stubs/qiskit_algorithms.VQD.html">VQD</a></li>
<li class="toctree-l2"><a class="reference internal" href="../stubs/qiskit_algorithms.VQDResult.html">VQDResult</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../apidocs/qiskit_algorithms.gradients.html">Gradients (<code class="xref py py-mod docutils literal notranslate"><span class="pre">qiskit_algorithms.gradients</span></code>)</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle navigation of Gradients (qiskit_algorithms.gradients)</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_algorithms.gradients.BaseEstimatorGradient.html">BaseEstimatorGradient</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_algorithms.gradients.BaseQGT.html">BaseQGT</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_algorithms.gradients.BaseSamplerGradient.html">BaseSamplerGradient</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_algorithms.gradients.EstimatorGradientResult.html">EstimatorGradientResult</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_algorithms.gradients.SamplerGradientResult.html">SamplerGradientResult</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_algorithms.gradients.QGTResult.html">QGTResult</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_algorithms.gradients.FiniteDiffEstimatorGradient.html">FiniteDiffEstimatorGradient</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_algorithms.gradients.FiniteDiffSamplerGradient.html">FiniteDiffSamplerGradient</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_algorithms.gradients.LinCombEstimatorGradient.html">LinCombEstimatorGradient</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_algorithms.gradients.LinCombSamplerGradient.html">LinCombSamplerGradient</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_algorithms.gradients.LinCombQGT.html">LinCombQGT</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_algorithms.gradients.ParamShiftEstimatorGradient.html">ParamShiftEstimatorGradient</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_algorithms.gradients.ParamShiftSamplerGradient.html">ParamShiftSamplerGradient</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_algorithms.gradients.QFIResult.html">QFIResult</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_algorithms.gradients.QFI.html">QFI</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_algorithms.gradients.ReverseEstimatorGradient.html">ReverseEstimatorGradient</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_algorithms.gradients.ReverseQGT.html">ReverseQGT</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_algorithms.gradients.SPSAEstimatorGradient.html">SPSAEstimatorGradient</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_algorithms.gradients.SPSASamplerGradient.html">SPSASamplerGradient</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../stubs/qiskit_algorithms.MinimumEigensolver.html">MinimumEigensolver</a></li>
<li class="toctree-l2"><a class="reference internal" href="../stubs/qiskit_algorithms.MinimumEigensolverResult.html">MinimumEigensolverResult</a></li>
<li class="toctree-l2"><a class="reference internal" href="../stubs/qiskit_algorithms.NumPyMinimumEigensolver.html">NumPyMinimumEigensolver</a></li>
<li class="toctree-l2"><a class="reference internal" href="../stubs/qiskit_algorithms.NumPyMinimumEigensolverResult.html">NumPyMinimumEigensolverResult</a></li>
<li class="toctree-l2"><a class="reference internal" href="../stubs/qiskit_algorithms.VQE.html">VQE</a></li>
<li class="toctree-l2"><a class="reference internal" href="../stubs/qiskit_algorithms.VQEResult.html">VQEResult</a></li>
<li class="toctree-l2"><a class="reference internal" href="../stubs/qiskit_algorithms.AdaptVQE.html">AdaptVQE</a></li>
<li class="toctree-l2"><a class="reference internal" href="../stubs/qiskit_algorithms.AdaptVQEResult.html">AdaptVQEResult</a></li>
<li class="toctree-l2"><a class="reference internal" href="../stubs/qiskit_algorithms.SamplingMinimumEigensolver.html">SamplingMinimumEigensolver</a></li>
<li class="toctree-l2"><a class="reference internal" href="../stubs/qiskit_algorithms.SamplingMinimumEigensolverResult.html">SamplingMinimumEigensolverResult</a></li>
<li class="toctree-l2"><a class="reference internal" href="../stubs/qiskit_algorithms.SamplingVQE.html">SamplingVQE</a></li>
<li class="toctree-l2"><a class="reference internal" href="../stubs/qiskit_algorithms.SamplingVQEResult.html">SamplingVQEResult</a></li>
<li class="toctree-l2"><a class="reference internal" href="../stubs/qiskit_algorithms.QAOA.html">QAOA</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../apidocs/qiskit_algorithms.optimizers.html">Optimizers (<code class="xref py py-mod docutils literal notranslate"><span class="pre">qiskit_algorithms.optimizers</span></code>)</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle navigation of Optimizers (qiskit_algorithms.optimizers)</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_algorithms.optimizers.OptimizerResult.html">OptimizerResult</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_algorithms.optimizers.Optimizer.html">Optimizer</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_algorithms.optimizers.Minimizer.html">Minimizer</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../stubs/qiskit_algorithms.optimizers.optimizer_utils.html">qiskit_algorithms.optimizers.optimizer_utils</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><div class="visually-hidden">Toggle navigation of qiskit_algorithms.optimizers.optimizer_utils</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../stubs/qiskit_algorithms.optimizers.optimizer_utils.LearningRate.html">LearningRate</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_algorithms.optimizers.SteppableOptimizer.html">SteppableOptimizer</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_algorithms.optimizers.AskData.html">AskData</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_algorithms.optimizers.TellData.html">TellData</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_algorithms.optimizers.OptimizerState.html">OptimizerState</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_algorithms.optimizers.ADAM.html">ADAM</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_algorithms.optimizers.AQGD.html">AQGD</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_algorithms.optimizers.CG.html">CG</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_algorithms.optimizers.COBYLA.html">COBYLA</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_algorithms.optimizers.L_BFGS_B.html">L_BFGS_B</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_algorithms.optimizers.GSLS.html">GSLS</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_algorithms.optimizers.GradientDescent.html">GradientDescent</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_algorithms.optimizers.GradientDescentState.html">GradientDescentState</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_algorithms.optimizers.NELDER_MEAD.html">NELDER_MEAD</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_algorithms.optimizers.NFT.html">NFT</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_algorithms.optimizers.P_BFGS.html">P_BFGS</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_algorithms.optimizers.POWELL.html">POWELL</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_algorithms.optimizers.SLSQP.html">SLSQP</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_algorithms.optimizers.SPSA.html">SPSA</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_algorithms.optimizers.QNSPSA.html">QNSPSA</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_algorithms.optimizers.TNC.html">TNC</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_algorithms.optimizers.SciPyOptimizer.html">SciPyOptimizer</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_algorithms.optimizers.UMDA.html">UMDA</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_algorithms.optimizers.BOBYQA.html">BOBYQA</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_algorithms.optimizers.IMFIL.html">IMFIL</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_algorithms.optimizers.SNOBFIT.html">SNOBFIT</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_algorithms.optimizers.SBPLX.html">SBPLX</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_algorithms.optimizers.CRS.html">CRS</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_algorithms.optimizers.DIRECT_L.html">DIRECT_L</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_algorithms.optimizers.DIRECT_L_RAND.html">DIRECT_L_RAND</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_algorithms.optimizers.ESCH.html">ESCH</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_algorithms.optimizers.ISRES.html">ISRES</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../stubs/qiskit_algorithms.HamiltonianPhaseEstimation.html">HamiltonianPhaseEstimation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../stubs/qiskit_algorithms.HamiltonianPhaseEstimationResult.html">HamiltonianPhaseEstimationResult</a></li>
<li class="toctree-l2"><a class="reference internal" href="../stubs/qiskit_algorithms.PhaseEstimationScale.html">PhaseEstimationScale</a></li>
<li class="toctree-l2"><a class="reference internal" href="../stubs/qiskit_algorithms.PhaseEstimation.html">PhaseEstimation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../stubs/qiskit_algorithms.PhaseEstimationResult.html">PhaseEstimationResult</a></li>
<li class="toctree-l2"><a class="reference internal" href="../stubs/qiskit_algorithms.IterativePhaseEstimation.html">IterativePhaseEstimation</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../apidocs/qiskit_algorithms.state_fidelities.html">State Fidelities (<code class="xref py py-mod docutils literal notranslate"><span class="pre">qiskit_algorithms.state_fidelities</span></code>)</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" role="switch" type="checkbox"/><label for="toctree-checkbox-5"><div class="visually-hidden">Toggle navigation of State Fidelities (qiskit_algorithms.state_fidelities)</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_algorithms.state_fidelities.BaseStateFidelity.html">BaseStateFidelity</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_algorithms.state_fidelities.ComputeUncompute.html">ComputeUncompute</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_algorithms.state_fidelities.StateFidelityResult.html">StateFidelityResult</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../stubs/qiskit_algorithms.RealTimeEvolver.html">RealTimeEvolver</a></li>
<li class="toctree-l2"><a class="reference internal" href="../stubs/qiskit_algorithms.ImaginaryTimeEvolver.html">ImaginaryTimeEvolver</a></li>
<li class="toctree-l2"><a class="reference internal" href="../stubs/qiskit_algorithms.TimeEvolutionResult.html">TimeEvolutionResult</a></li>
<li class="toctree-l2"><a class="reference internal" href="../stubs/qiskit_algorithms.TimeEvolutionProblem.html">TimeEvolutionProblem</a></li>
<li class="toctree-l2"><a class="reference internal" href="../stubs/qiskit_algorithms.PVQD.html">PVQD</a></li>
<li class="toctree-l2"><a class="reference internal" href="../stubs/qiskit_algorithms.PVQDResult.html">PVQDResult</a></li>
<li class="toctree-l2"><a class="reference internal" href="../stubs/qiskit_algorithms.SciPyImaginaryEvolver.html">SciPyImaginaryEvolver</a></li>
<li class="toctree-l2"><a class="reference internal" href="../stubs/qiskit_algorithms.SciPyRealEvolver.html">SciPyRealEvolver</a></li>
<li class="toctree-l2"><a class="reference internal" href="../stubs/qiskit_algorithms.TrotterQRTE.html">TrotterQRTE</a></li>
<li class="toctree-l2"><a class="reference internal" href="../stubs/qiskit_algorithms.VarQITE.html">VarQITE</a></li>
<li class="toctree-l2"><a class="reference internal" href="../stubs/qiskit_algorithms.VarQRTE.html">VarQRTE</a></li>
<li class="toctree-l2"><a class="reference internal" href="../stubs/qiskit_algorithms.VarQTEResult.html">VarQTEResult</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../apidocs/qiskit_algorithms.time_evolvers.variational.html">Time Evolvers, Variational (<code class="xref py py-mod docutils literal notranslate"><span class="pre">qiskit_algorithms.time_evolvers.variational</span></code>)</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" role="switch" type="checkbox"/><label for="toctree-checkbox-6"><div class="visually-hidden">Toggle navigation of Time Evolvers, Variational (qiskit_algorithms.time_evolvers.variational)</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_algorithms.time_evolvers.variational.VariationalPrinciple.html">VariationalPrinciple</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_algorithms.time_evolvers.variational.RealVariationalPrinciple.html">RealVariationalPrinciple</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_algorithms.time_evolvers.variational.ImaginaryVariationalPrinciple.html">ImaginaryVariationalPrinciple</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_algorithms.time_evolvers.variational.RealMcLachlanPrinciple.html">RealMcLachlanPrinciple</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_algorithms.time_evolvers.variational.ImaginaryMcLachlanPrinciple.html">ImaginaryMcLachlanPrinciple</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_algorithms.time_evolvers.variational.ForwardEulerSolver.html">ForwardEulerSolver</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../apidocs/qiskit_algorithms.AlgorithmError.html">AlgorithmError</a></li>
<li class="toctree-l2"><a class="reference internal" href="../stubs/qiskit_algorithms.AlgorithmJob.html">AlgorithmJob</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apidocs/qiskit_algorithms.utils.algorithm_globals.html">utils.algorithm_globals</a></li>
</ul>
</li>
<li class="toctree-l1 current has-children"><a class="reference internal" href="index.html">Tutorials</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" role="switch" type="checkbox"/><label for="toctree-checkbox-7"><div class="visually-hidden">Toggle navigation of Tutorials</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="01_algorithms_introduction.html">An Introduction to Algorithms using Qiskit</a></li>
<li class="toctree-l2"><a class="reference internal" href="02_vqe_advanced_options.html">Advanced VQE Options</a></li>
<li class="toctree-l2"><a class="reference internal" href="03_vqe_simulation_with_noise.html">VQE with Qiskit Aer Primitives</a></li>
<li class="toctree-l2"><a class="reference internal" href="04_vqd.html">Variational Quantum Deflation (VQD) Algorithm</a></li>
<li class="toctree-l2"><a class="reference internal" href="05_qaoa.html">Quantum Approximate Optimization Algorithm</a></li>
<li class="toctree-l2"><a class="reference internal" href="06_grover.html">Grover’s Algorithm and Amplitude Amplification</a></li>
<li class="toctree-l2"><a class="reference internal" href="07_grover_examples.html">Grover’s algorithm examples</a></li>
<li class="toctree-l2 current current-page"><a class="current reference internal" href="#">Projected Variational Quantum Dynamics</a></li>
<li class="toctree-l2"><a class="reference internal" href="11_VarQTE.html">Variational Quantum Time Evolution</a></li>
<li class="toctree-l2"><a class="reference internal" href="12_gradients_framework.html">Gradient Framework</a></li>
<li class="toctree-l2"><a class="reference internal" href="13_trotterQRTE.html">Quantum Real Time Evolution using Trotterization</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../release_notes.html">Release Notes</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/qiskit-community/qiskit-algorithms">GitHub</a></li>
</ul>

</div></div>
      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <div class="admonition note">
<p class="admonition-title">Note</p>
<p>This page was generated from <a class="reference external" href="https://github.com/qiskit-community/qiskit-algorithms/blob/stable/0.4/docs/tutorials/10_pvqd.ipynb">docs/tutorials/10_pvqd.ipynb</a>.</p>
</div>
<section id="Projected-Variational-Quantum-Dynamics">
<h1>Projected Variational Quantum Dynamics<a class="headerlink" href="#Projected-Variational-Quantum-Dynamics" title="Link to this heading">¶</a></h1>
<p>The projected Variational Quantum Dynamics (p-VQD) algorithm is a quantum algorithm for real time evolution. It’s a variational algorithm that projects the state at time <span class="math notranslate nohighlight">\(t + \Delta_t\)</span>, as calculated with Trotterization, onto a parameterized quantum circuit.</p>
<p>For a quantum state <span class="math notranslate nohighlight">\(|\phi(\theta)\rangle = U(\theta)|0\rangle\)</span> constructed by a parameterized quantum circuit <span class="math notranslate nohighlight">\(U(\theta)\)</span> and a Hamiltonian <span class="math notranslate nohighlight">\(H\)</span>, the update rule can be written as</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\theta_{n+1} = \theta_n + \arg\min_{\delta\theta} 1 - |\langle\phi(\theta_n + \delta\theta)|e^{-i\Delta_t H}|\phi(\theta_n)\rangle|^2,\]</div>
</div>
<p>where <span class="math notranslate nohighlight">\(e^{-i\Delta_t H}\)</span> is calculated with a Trotter expansion (using e.g. the <a class="reference external" href="https://quantum.cloud.ibm.com/docs/api/qiskit/qiskit.circuit.library.PauliEvolutionGate">PauliEvolutionGate</a> in Qiskit!).</p>
<p>The following tutorial explores the p-VQD algorithm, which is available as the <a class="reference external" href="https://qiskit-community.github.io/qiskit-algorithms/stubs/qiskit_algorithms.PVQD.html">PVQD</a> class. For details on the algorithm, see the original paper: <a class="reference external" href="https://quantum-journal.org/papers/q-2021-07-28-512/#">Barison et al. Quantum 5, 512 (2021)</a>.</p>
<p>The example we’re looking at is the time evolution of the <span class="math notranslate nohighlight">\(|00\rangle\)</span> state under the Hamiltonian</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[H = 0.1 Z_1 Z_2 + X_1 + X_2,\]</div>
</div>
<p>which is an Ising Hamiltonian on two neighboring spins, up to a time <span class="math notranslate nohighlight">\(T=1\)</span>, where we want to keep track of the total magnetization <span class="math notranslate nohighlight">\(M = Z_1 + Z_2\)</span> as an observable.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">qiskit.quantum_info</span><span class="w"> </span><span class="kn">import</span> <span class="n">SparsePauliOp</span>

<span class="n">final_time</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">hamiltonian</span> <span class="o">=</span> <span class="n">SparsePauliOp</span><span class="o">.</span><span class="n">from_sparse_list</span><span class="p">(</span>
    <span class="p">[</span>
        <span class="p">(</span><span class="s2">&quot;ZZ&quot;</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="mf">0.1</span><span class="p">),</span>
        <span class="p">(</span><span class="s2">&quot;X&quot;</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">1</span><span class="p">),</span>
        <span class="p">(</span><span class="s2">&quot;X&quot;</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">1</span><span class="p">),</span>
    <span class="p">],</span>
    <span class="n">num_qubits</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">observable</span> <span class="o">=</span> <span class="n">SparsePauliOp</span><span class="p">([</span><span class="s2">&quot;ZI&quot;</span><span class="p">,</span> <span class="s2">&quot;IZ&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<p>After defining our Hamiltonian and observable, we need to choose the parameterized ansatz we project the update steps onto. We have different choices here, but for real time evolution an ansatz that contains building blocks of the evolved Hamiltonian usually performs very well.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">qiskit.circuit</span><span class="w"> </span><span class="kn">import</span> <span class="n">QuantumCircuit</span><span class="p">,</span> <span class="n">ParameterVector</span>

<span class="n">theta</span> <span class="o">=</span> <span class="n">ParameterVector</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$\theta$&quot;</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="n">ansatz</span> <span class="o">=</span> <span class="n">QuantumCircuit</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ansatz</span><span class="o">.</span><span class="n">rx</span><span class="p">(</span><span class="n">theta</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">ansatz</span><span class="o">.</span><span class="n">rx</span><span class="p">(</span><span class="n">theta</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">ansatz</span><span class="o">.</span><span class="n">rzz</span><span class="p">(</span><span class="n">theta</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">ansatz</span><span class="o">.</span><span class="n">rx</span><span class="p">(</span><span class="n">theta</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">ansatz</span><span class="o">.</span><span class="n">rx</span><span class="p">(</span><span class="n">theta</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="mi">1</span><span class="p">)</span>

<span class="c1"># you can try different circuits, like:</span>
<span class="c1"># from qiskit.circuit.library import efficient_su2</span>
<span class="c1"># ansatz = efficient_su2(2, reps=1)</span>

<span class="n">ansatz</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="s2">&quot;mpl&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_10_pvqd_4_0.png" src="../_images/tutorials_10_pvqd_4_0.png" />
</div>
</div>
<p>With this ansatz, the <span class="math notranslate nohighlight">\(|00\rangle\)</span> state is prepared if all parameters are 0. Hence we’ll set the initial parameters to <span class="math notranslate nohighlight">\(\theta_0 = 0\)</span>:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="n">initial_parameters</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">ansatz</span><span class="o">.</span><span class="n">num_parameters</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Before running the p-VQD algorithm, we need to select the backend and how we want to calculate the expectation values. Here, we’ll perform exact statevector simulations (which are still very fast, as we investigate a 2 qubit system) through the reference primitive implementations found in <code class="docutils literal notranslate"><span class="pre">qiskit.primitives</span></code>.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">qiskit.primitives</span><span class="w"> </span><span class="kn">import</span> <span class="n">StatevectorSampler</span><span class="p">,</span> <span class="n">StatevectorEstimator</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">qiskit_algorithms.state_fidelities</span><span class="w"> </span><span class="kn">import</span> <span class="n">ComputeUncompute</span>

<span class="c1"># the fidelity is used to evaluate the objective: the overlap of the variational form and the trotter step</span>
<span class="n">sampler</span> <span class="o">=</span> <span class="n">StatevectorSampler</span><span class="p">(</span><span class="n">default_shots</span><span class="o">=</span><span class="mi">10_000</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
<span class="n">fidelity</span> <span class="o">=</span> <span class="n">ComputeUncompute</span><span class="p">(</span><span class="n">sampler</span><span class="p">)</span>

<span class="c1"># the estimator is used to evaluate the observables</span>
<span class="n">estimator</span> <span class="o">=</span> <span class="n">StatevectorEstimator</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="mi">43</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Since p-VQD performs a classical optimization in each timestep to determine the best parameters for the projection, we also have to specify the classical optimizer. As a first example we’re using BFGS, which typically works well in statevector simulations, but later we can switch to gradient descent.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">qiskit_algorithms.optimizers</span><span class="w"> </span><span class="kn">import</span> <span class="n">L_BFGS_B</span>

<span class="n">bfgs</span> <span class="o">=</span> <span class="n">L_BFGS_B</span><span class="p">()</span>
</pre></div>
</div>
</div>
<p>Now we can define p-VQD and execute it!</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">qiskit_algorithms</span><span class="w"> </span><span class="kn">import</span> <span class="n">PVQD</span>

<span class="n">pvqd</span> <span class="o">=</span> <span class="n">PVQD</span><span class="p">(</span>
    <span class="n">fidelity</span><span class="p">,</span> <span class="n">ansatz</span><span class="p">,</span> <span class="n">initial_parameters</span><span class="p">,</span> <span class="n">estimator</span><span class="o">=</span><span class="n">estimator</span><span class="p">,</span> <span class="n">num_timesteps</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">optimizer</span><span class="o">=</span><span class="n">bfgs</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<p>The p-VQD implementation follows Qiskit’s time evolution interface, thus we pack all information of the evolution problem into an input class: the <code class="docutils literal notranslate"><span class="pre">hamiltonian</span></code> under which we evolve the state, the <code class="docutils literal notranslate"><span class="pre">final_time</span></code> of the evolution and the observables (<code class="docutils literal notranslate"><span class="pre">aux_operators</span></code>) we keep track of.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">qiskit_algorithms</span><span class="w"> </span><span class="kn">import</span> <span class="n">TimeEvolutionProblem</span>

<span class="n">problem</span> <span class="o">=</span> <span class="n">TimeEvolutionProblem</span><span class="p">(</span>
    <span class="n">hamiltonian</span><span class="p">,</span> <span class="n">time</span><span class="o">=</span><span class="n">final_time</span><span class="p">,</span> <span class="n">aux_operators</span><span class="o">=</span><span class="p">[</span><span class="n">hamiltonian</span><span class="p">,</span> <span class="n">observable</span><span class="p">]</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<p>And then run the algorithm! Beware that for a large number of shots to compute the fidelity, running the algorithm might take a while.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">result</span> <span class="o">=</span> <span class="n">pvqd</span><span class="o">.</span><span class="n">evolve</span><span class="p">(</span><span class="n">problem</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
{   &#39;aux_ops_evaluated&#39;: array([ 0.58497693, -0.4890591 ]),
    &#39;estimated_error&#39;: 0.0,
    &#39;evolved_state&#39;: &lt;qiskit.circuit.quantumcircuit.QuantumCircuit object at 0x7f8d7144d5a0&gt;,
    &#39;fidelities&#39;: [   1.0,
                      np.float64(1.0),
                      np.float64(1.0),
                      np.float64(1.0),
                      np.float64(1.0),
                      np.float64(1.0),
                      np.float64(1.0),
                      np.float64(1.0),
                      np.float64(1.0),
                      np.float64(1.0),
                      np.float64(1.0),
                      np.float64(1.0),
                      np.float64(1.0),
                      np.float64(1.0),
                      np.float64(1.0),
                      np.float64(1.0),
                      np.float64(1.0),
                      np.float64(1.0),
                      np.float64(1.0),
                      np.float64(1.0),
                      np.float64(1.0),
                      np.float64(1.0),
                      np.float64(1.0),
                      np.float64(1.0),
                      np.float64(1.0),
                      np.float64(1.0),
                      np.float64(1.0),
                      np.float64(1.0),
                      np.float64(1.0),
                      np.float64(1.0),
                      np.float64(1.0),
                      np.float64(1.0),
                      np.float64(1.0),
                      np.float64(1.0),
                      np.float64(1.0),
                      np.float64(1.0),
                      np.float64(1.0),
                      np.float64(1.0),
                      np.float64(1.0),
                      np.float64(1.0),
                      np.float64(1.0),
                      np.float64(1.0),
                      np.float64(1.0),
                      np.float64(1.0),
                      np.float64(1.0),
                      np.float64(1.0),
                      np.float64(1.0),
                      np.float64(1.0),
                      np.float64(1.0),
                      np.float64(1.0),
                      np.float64(1.0),
                      np.float64(1.0),
                      np.float64(1.0),
                      np.float64(1.0),
                      np.float64(1.0),
                      np.float64(1.0),
                      np.float64(1.0),
                      np.float64(1.0),
                      np.float64(1.0),
                      np.float64(1.0),
                      np.float64(1.0),
                      np.float64(1.0),
                      np.float64(1.0),
                      np.float64(1.0),
                      np.float64(1.0),
                      np.float64(1.0),
                      np.float64(1.0),
                      np.float64(1.0),
                      np.float64(1.0),
                      np.float64(1.0),
                      np.float64(1.0),
                      np.float64(1.0),
                      np.float64(1.0),
                      np.float64(1.0),
                      np.float64(1.0),
                      np.float64(1.0),
                      np.float64(1.0),
                      np.float64(1.0),
                      np.float64(1.0),
                      np.float64(1.0),
                      np.float64(1.0),
                      np.float64(1.0),
                      np.float64(1.0),
                      np.float64(1.0),
                      np.float64(1.0),
                      np.float64(1.0),
                      np.float64(1.0),
                      np.float64(1.0),
                      np.float64(1.0),
                      np.float64(1.0),
                      np.float64(1.0),
                      np.float64(1.0),
                      np.float64(1.0),
                      np.float64(1.0),
                      np.float64(1.0),
                      np.float64(1.0),
                      np.float64(1.0),
                      np.float64(1.0),
                      np.float64(1.0),
                      np.float64(1.0),
                      np.float64(1.0)],
    &#39;observables&#39;: [   array([0.1, 2. ]),
                       array([0.10008343, 1.99961541]),
                       array([0.10033367, 1.99846185]),
                       array([0.10075063, 1.99653989]),
                       array([0.10133412, 1.99385052]),
                       array([0.10208391, 1.99039509]),
                       array([0.10299967, 1.98617535]),
                       array([0.10408103, 1.98119346]),
                       array([0.10532751, 1.97545192]),
                       array([0.1067386 , 1.96895365]),
                       array([0.10831369, 1.96170194]),
                       array([0.1100521 , 1.95370047]),
                       array([0.11195309, 1.94495328]),
                       array([0.11401582, 1.93546482]),
                       array([0.11623941, 1.92523988]),
                       array([0.11862286, 1.91428364]),
                       array([0.12116513, 1.90260165]),
                       array([0.12386509, 1.89019982]),
                       array([0.12672152, 1.87708442]),
                       array([0.12973312, 1.86326209]),
                       array([0.13289852, 1.84873982]),
                       array([0.13621626, 1.83352495]),
                       array([0.13968479, 1.81762517]),
                       array([0.14330249, 1.80104852]),
                       array([0.14706763, 1.78380336]),
                       array([0.1509784 , 1.76589842]),
                       array([0.15503292, 1.74734271]),
                       array([0.15922918, 1.72814562]),
                       array([0.16356511, 1.70831682]),
                       array([0.16803853, 1.6878663 ]),
                       array([0.17264717, 1.66680439]),
                       array([0.17738865, 1.64514168]),
                       array([0.18226052, 1.62288908]),
                       array([0.1872602, 1.6000578]),
                       array([0.19238503, 1.57665933]),
                       array([0.19763223, 1.55270542]),
                       array([0.20299893, 1.52820812]),
                       array([0.20848215, 1.50317973]),
                       array([0.21407882, 1.47763282]),
                       array([0.21978573, 1.4515802 ]),
                       array([0.2255996 , 1.42503495]),
                       array([0.23151701, 1.39801036]),
                       array([0.23753446, 1.37051997]),
                       array([0.24364832, 1.34257753]),
                       array([0.24985486, 1.31419704]),
                       array([0.25615024, 1.28539266]),
                       array([0.26253049, 1.2561788 ]),
                       array([0.26899156, 1.22657003]),
                       array([0.27552927, 1.19658112]),
                       array([0.28213934, 1.16622702]),
                       array([0.28881735, 1.13552284]),
                       array([0.29555882, 1.10448386]),
                       array([0.30235911, 1.07312552]),
                       array([0.30921351, 1.04146339]),
                       array([0.31611717, 1.00951318]),
                       array([0.32306515, 0.97729075]),
                       array([0.33005241, 0.94481206]),
                       array([0.33707378, 0.91209317]),
                       array([0.34412402, 0.87915027]),
                       array([0.35119775, 0.84599964]),
                       array([0.35828952, 0.81265762]),
                       array([0.36539376, 0.77914066]),
                       array([0.37250481, 0.74546526]),
                       array([0.37961694, 0.71164799]),
                       array([0.38672429, 0.67770545]),
                       array([0.39382093, 0.64365431]),
                       array([0.40090084, 0.60951126]),
                       array([0.40795792, 0.575293  ]),
                       array([0.41498599, 0.54101626]),
                       array([0.4219788 , 0.50669779]),
                       array([0.42892999, 0.47235432]),
                       array([0.43583319, 0.43800256]),
                       array([0.44268191, 0.40365923]),
                       array([0.44946964, 0.36934099]),
                       array([0.45618978, 0.33506448]),
                       array([0.46283569, 0.3008463 ]),
                       array([0.46940069, 0.26670297]),
                       array([0.47587805, 0.23265099]),
                       array([0.482261  , 0.19870674]),
                       array([0.48854274, 0.16488654]),
                       array([0.49471642, 0.13120664]),
                       array([0.50077521, 0.09768317]),
                       array([0.50671223, 0.06433216]),
                       array([0.5125206 , 0.03116953]),
                       array([ 0.51819342, -0.00178893]),
                       array([ 0.52372381, -0.03452755]),
                       array([ 0.52910489, -0.06703079]),
                       array([ 0.53432978, -0.09928329]),
                       array([ 0.53939164, -0.13126979]),
                       array([ 0.54428363, -0.16297525]),
                       array([ 0.54899896, -0.19438475]),
                       array([ 0.55353088, -0.22548357]),
                       array([ 0.55787267, -0.25625717]),
                       array([ 0.56201767, -0.2866912 ]),
                       array([ 0.56595928, -0.3167715 ]),
                       array([ 0.56969095, -0.34648412]),
                       array([ 0.57320623, -0.37581534]),
                       array([ 0.57649872, -0.40475162]),
                       array([ 0.57956212, -0.43327968]),
                       array([ 0.58239023, -0.46138645]),
                       array([ 0.58497693, -0.4890591 ])],
    &#39;parameters&#39;: [   array([0., 0., 0., 0., 0.]),
                      array([0.00946808, 0.00962316, 0.00638458, 0.01037215, 0.00975647]),
                      array([0.01893616, 0.01924631, 0.01276915, 0.0207443 , 0.01951295]),
                      array([0.02840425, 0.02886947, 0.01915373, 0.03111646, 0.02926942]),
                      array([0.03787233, 0.03849263, 0.02553831, 0.04148861, 0.03902589]),
                      array([0.04734041, 0.04811579, 0.03192288, 0.05186076, 0.04878237]),
                      array([0.05680849, 0.05773894, 0.03830746, 0.06223291, 0.05853884]),
                      array([0.06627658, 0.0673621 , 0.04469204, 0.07260506, 0.06829532]),
                      array([0.07574466, 0.07698526, 0.05107662, 0.08297721, 0.07805179]),
                      array([0.08521274, 0.08660841, 0.05746119, 0.09334937, 0.08780826]),
                      array([0.09468082, 0.09623157, 0.06384577, 0.10372152, 0.09756474]),
                      array([0.1041489 , 0.10585473, 0.07023035, 0.11409367, 0.10732121]),
                      array([0.11361699, 0.11547789, 0.07661492, 0.12446582, 0.11707768]),
                      array([0.12308507, 0.12510104, 0.0829995 , 0.13483797, 0.12683416]),
                      array([0.13255315, 0.1347242 , 0.08938408, 0.14521013, 0.13659063]),
                      array([0.14202123, 0.14434736, 0.09576865, 0.15558228, 0.1463471 ]),
                      array([0.15148932, 0.15397051, 0.10215323, 0.16595443, 0.15610358]),
                      array([0.1609574 , 0.16359367, 0.10853781, 0.17632658, 0.16586005]),
                      array([0.17042548, 0.17321683, 0.11492238, 0.18669873, 0.17561653]),
                      array([0.17989356, 0.18283999, 0.12130696, 0.19707089, 0.185373  ]),
                      array([0.18936164, 0.19246314, 0.12769154, 0.20744304, 0.19512947]),
                      array([0.19882973, 0.2020863 , 0.13407611, 0.21781519, 0.20488595]),
                      array([0.20829781, 0.21170946, 0.14046069, 0.22818734, 0.21464242]),
                      array([0.21776589, 0.22133261, 0.14684527, 0.23855949, 0.22439889]),
                      array([0.22723397, 0.23095577, 0.15322985, 0.24893164, 0.23415537]),
                      array([0.23670206, 0.24057893, 0.15961442, 0.2593038 , 0.24391184]),
                      array([0.24617014, 0.25020209, 0.165999  , 0.26967595, 0.25366832]),
                      array([0.25563822, 0.25982524, 0.17238358, 0.2800481 , 0.26342479]),
                      array([0.2651063 , 0.2694484 , 0.17876815, 0.29042025, 0.27318126]),
                      array([0.27457439, 0.27907156, 0.18515273, 0.3007924 , 0.28293774]),
                      array([0.28404247, 0.28869471, 0.19153731, 0.31116456, 0.29269421]),
                      array([0.29351055, 0.29831787, 0.19792188, 0.32153671, 0.30245068]),
                      array([0.30297863, 0.30794103, 0.20430646, 0.33190886, 0.31220716]),
                      array([0.31244671, 0.31756419, 0.21069104, 0.34228101, 0.32196363]),
                      array([0.3219148 , 0.32718734, 0.21707561, 0.35265316, 0.3317201 ]),
                      array([0.33138288, 0.3368105 , 0.22346019, 0.36302532, 0.34147658]),
                      array([0.34085096, 0.34643366, 0.22984477, 0.37339747, 0.35123305]),
                      array([0.35031904, 0.35605681, 0.23622935, 0.38376962, 0.36098953]),
                      array([0.35978713, 0.36567997, 0.24261392, 0.39414177, 0.370746  ]),
                      array([0.36925521, 0.37530313, 0.2489985 , 0.40451392, 0.38050247]),
                      array([0.37872329, 0.38492629, 0.25538308, 0.41488607, 0.39025895]),
                      array([0.38819137, 0.39454944, 0.26176765, 0.42525823, 0.40001542]),
                      array([0.39765945, 0.4041726 , 0.26815223, 0.43563038, 0.40977189]),
                      array([0.40712754, 0.41379576, 0.27453681, 0.44600253, 0.41952837]),
                      array([0.41659562, 0.42341891, 0.28092138, 0.45637468, 0.42928484]),
                      array([0.4260637 , 0.43304207, 0.28730596, 0.46674683, 0.43904131]),
                      array([0.43553178, 0.44266523, 0.29369054, 0.47711899, 0.44879779]),
                      array([0.44499987, 0.45228839, 0.30007511, 0.48749114, 0.45855426]),
                      array([0.45446795, 0.46191154, 0.30645969, 0.49786329, 0.46831074]),
                      array([0.46393603, 0.4715347 , 0.31284427, 0.50823544, 0.47806721]),
                      array([0.47340411, 0.48115786, 0.31922884, 0.51860759, 0.48782368]),
                      array([0.48287219, 0.49078101, 0.32561342, 0.52897974, 0.49758016]),
                      array([0.49234028, 0.50040417, 0.331998  , 0.5393519 , 0.50733663]),
                      array([0.50180836, 0.51002733, 0.33838258, 0.54972405, 0.5170931 ]),
                      array([0.51127644, 0.51965049, 0.34476715, 0.5600962 , 0.52684958]),
                      array([0.52074452, 0.52927364, 0.35115173, 0.57046835, 0.53660605]),
                      array([0.53021261, 0.5388968 , 0.35753631, 0.5808405 , 0.54636253]),
                      array([0.53968069, 0.54851996, 0.36392088, 0.59121266, 0.556119  ]),
                      array([0.54914877, 0.55814311, 0.37030546, 0.60158481, 0.56587547]),
                      array([0.55861685, 0.56776627, 0.37669004, 0.61195696, 0.57563195]),
                      array([0.56808493, 0.57738943, 0.38307461, 0.62232911, 0.58538842]),
                      array([0.57755302, 0.58701259, 0.38945919, 0.63270126, 0.59514489]),
                      array([0.5870211 , 0.59663574, 0.39584377, 0.64307342, 0.60490137]),
                      array([0.59648918, 0.6062589 , 0.40222834, 0.65344557, 0.61465784]),
                      array([0.60595726, 0.61588206, 0.40861292, 0.66381772, 0.62441431]),
                      array([0.61542535, 0.62550521, 0.4149975 , 0.67418987, 0.63417079]),
                      array([0.62489343, 0.63512837, 0.42138208, 0.68456202, 0.64392726]),
                      array([0.63436151, 0.64475153, 0.42776665, 0.69493417, 0.65368374]),
                      array([0.64382959, 0.65437469, 0.43415123, 0.70530633, 0.66344021]),
                      array([0.65329767, 0.66399784, 0.44053581, 0.71567848, 0.67319668]),
                      array([0.66276576, 0.673621  , 0.44692038, 0.72605063, 0.68295316]),
                      array([0.67223384, 0.68324416, 0.45330496, 0.73642278, 0.69270963]),
                      array([0.68170192, 0.69286731, 0.45968954, 0.74679493, 0.7024661 ]),
                      array([0.69117   , 0.70249047, 0.46607411, 0.75716709, 0.71222258]),
                      array([0.70063809, 0.71211363, 0.47245869, 0.76753924, 0.72197905]),
                      array([0.71010617, 0.72173679, 0.47884327, 0.77791139, 0.73173552]),
                      array([0.71957425, 0.73135994, 0.48522784, 0.78828354, 0.741492  ]),
                      array([0.72904233, 0.7409831 , 0.49161242, 0.79865569, 0.75124847]),
                      array([0.73851041, 0.75060626, 0.497997  , 0.80902785, 0.76100495]),
                      array([0.7479785 , 0.76022941, 0.50438157, 0.8194    , 0.77076142]),
                      array([0.75744658, 0.76985257, 0.51076615, 0.82977215, 0.78051789]),
                      array([0.76691466, 0.77947573, 0.51715073, 0.8401443 , 0.79027437]),
                      array([0.77638274, 0.78909889, 0.52353531, 0.85051645, 0.80003084]),
                      array([0.78585083, 0.79872204, 0.52991988, 0.8608886 , 0.80978731]),
                      array([0.79531891, 0.8083452 , 0.53630446, 0.87126076, 0.81954379]),
                      array([0.80478699, 0.81796836, 0.54268904, 0.88163291, 0.82930026]),
                      array([0.81425507, 0.82759151, 0.54907361, 0.89200506, 0.83905674]),
                      array([0.82372316, 0.83721467, 0.55545819, 0.90237721, 0.84881321]),
                      array([0.83319124, 0.84683783, 0.56184277, 0.91274936, 0.85856968]),
                      array([0.84265932, 0.85646099, 0.56822734, 0.92312152, 0.86832616]),
                      array([0.8521274 , 0.86608414, 0.57461192, 0.93349367, 0.87808263]),
                      array([0.86159548, 0.8757073 , 0.5809965 , 0.94386582, 0.8878391 ]),
                      array([0.87106357, 0.88533046, 0.58738107, 0.95423797, 0.89759558]),
                      array([0.88053165, 0.89495361, 0.59376565, 0.96461012, 0.90735205]),
                      array([0.88999973, 0.90457677, 0.60015023, 0.97498227, 0.91710852]),
                      array([0.89946781, 0.91419993, 0.60653481, 0.98535443, 0.926865  ]),
                      array([0.9089359 , 0.92382309, 0.61291938, 0.99572658, 0.93662147]),
                      array([0.91840398, 0.93344624, 0.61930396, 1.00609873, 0.94637795]),
                      array([0.92787206, 0.9430694 , 0.62568854, 1.01647088, 0.95613442]),
                      array([0.93734014, 0.95269256, 0.63207311, 1.02684303, 0.96589089]),
                      array([0.94680822, 0.96231571, 0.63845769, 1.03721519, 0.97564737])],
    &#39;times&#39;: [   0.0,
                 0.01,
                 0.02,
                 0.03,
                 0.04,
                 0.05,
                 0.06,
                 0.07,
                 0.08,
                 0.09,
                 0.1,
                 0.11,
                 0.12,
                 0.13,
                 0.14,
                 0.15,
                 0.16,
                 0.17,
                 0.18,
                 0.19,
                 0.2,
                 0.21,
                 0.22,
                 0.23,
                 0.24,
                 0.25,
                 0.26,
                 0.27,
                 0.28,
                 0.29,
                 0.3,
                 0.31,
                 0.32,
                 0.33,
                 0.34,
                 0.35000000000000003,
                 0.36,
                 0.37,
                 0.38,
                 0.39,
                 0.4,
                 0.41000000000000003,
                 0.42,
                 0.43,
                 0.44,
                 0.45,
                 0.46,
                 0.47000000000000003,
                 0.48,
                 0.49,
                 0.5,
                 0.51,
                 0.52,
                 0.53,
                 0.54,
                 0.55,
                 0.56,
                 0.5700000000000001,
                 0.58,
                 0.59,
                 0.6,
                 0.61,
                 0.62,
                 0.63,
                 0.64,
                 0.65,
                 0.66,
                 0.67,
                 0.68,
                 0.6900000000000001,
                 0.7000000000000001,
                 0.71,
                 0.72,
                 0.73,
                 0.74,
                 0.75,
                 0.76,
                 0.77,
                 0.78,
                 0.79,
                 0.8,
                 0.81,
                 0.8200000000000001,
                 0.8300000000000001,
                 0.84,
                 0.85,
                 0.86,
                 0.87,
                 0.88,
                 0.89,
                 0.9,
                 0.91,
                 0.92,
                 0.93,
                 0.9400000000000001,
                 0.9500000000000001,
                 0.96,
                 0.97,
                 0.98,
                 0.99,
                 1.0]}
</pre></div></div>
</div>
<p>Now we can have a look at the results, which are stored in a <code class="docutils literal notranslate"><span class="pre">PVQDResult</span></code> object. This class has the fields</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">evolved_state</span></code>: The quantum circuit with the parameters at the final evolution time.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">times</span></code>: The timesteps of the time integration. At these times we have the parameter values and evaluated the observables.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">parameters</span></code>: The parameter values at each timestep.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">observables</span></code>: The observable values at each timestep.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">fidelities</span></code>: The fidelity of projecting the Trotter timestep onto the variational form at each timestep.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">estimated_error</span></code>: The estimated error as product of all fidelities.</p></li>
</ul>
<p>The energy should be constant in a real time evolution. However, we are projecting the time-evolved state onto a variational form, which might violate this rule.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="n">energies</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">observables</span><span class="p">)[:,</span> <span class="mi">0</span><span class="p">]</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">times</span><span class="p">,</span> <span class="n">energies</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;royalblue&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;time $t$&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;energy $E$&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Energy over time&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Text(0.5, 1.0, &#39;Energy over time&#39;)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_10_pvqd_19_1.png" src="../_images/tutorials_10_pvqd_19_1.png" />
</div>
</div>
<p>Since we also kept track of the total magnetization of the system, we can plot that quantity too. However let’s first compute exact reference values to verify our algorithm results.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">scipy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sc</span>


<span class="k">def</span><span class="w"> </span><span class="nf">exact</span><span class="p">(</span><span class="n">final_time</span><span class="p">,</span> <span class="n">timestep</span><span class="p">,</span> <span class="n">hamiltonian</span><span class="p">,</span> <span class="n">initial_state</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get the exact values for energy and the observable.&quot;&quot;&quot;</span>
    <span class="n">O</span> <span class="o">=</span> <span class="n">observable</span><span class="o">.</span><span class="n">to_matrix</span><span class="p">()</span>
    <span class="n">H</span> <span class="o">=</span> <span class="n">hamiltonian</span><span class="o">.</span><span class="n">to_matrix</span><span class="p">()</span>

    <span class="n">energ</span><span class="p">,</span> <span class="n">magn</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>  <span class="c1"># list of energies and magnetizations evaluated at timesteps timestep</span>
    <span class="n">times</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># list of timepoints at which energy/obs are evaluated</span>
    <span class="n">time</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">while</span> <span class="n">time</span> <span class="o">&lt;=</span> <span class="n">final_time</span><span class="p">:</span>
        <span class="c1"># get exact state at time t</span>
        <span class="n">exact_state</span> <span class="o">=</span> <span class="n">initial_state</span><span class="o">.</span><span class="n">evolve</span><span class="p">(</span><span class="n">sc</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">expm</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">time</span> <span class="o">*</span> <span class="n">H</span><span class="p">))</span>
        <span class="c1"># store observables and time</span>
        <span class="n">times</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">time</span><span class="p">)</span>
        <span class="n">energ</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">exact_state</span><span class="o">.</span><span class="n">expectation_value</span><span class="p">(</span><span class="n">H</span><span class="p">)</span><span class="o">.</span><span class="n">real</span><span class="p">)</span>
        <span class="n">magn</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">exact_state</span><span class="o">.</span><span class="n">expectation_value</span><span class="p">(</span><span class="n">observable</span><span class="p">)</span><span class="o">.</span><span class="n">real</span><span class="p">)</span>

        <span class="c1"># next timestep</span>
        <span class="n">time</span> <span class="o">+=</span> <span class="n">timestep</span>

    <span class="k">return</span> <span class="n">times</span><span class="p">,</span> <span class="n">energ</span><span class="p">,</span> <span class="n">magn</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">qiskit.quantum_info</span><span class="w"> </span><span class="kn">import</span> <span class="n">Statevector</span>

<span class="n">initial_state</span> <span class="o">=</span> <span class="n">Statevector</span><span class="p">(</span><span class="n">ansatz</span><span class="o">.</span><span class="n">assign_parameters</span><span class="p">(</span><span class="n">initial_parameters</span><span class="p">))</span>
<span class="n">exact_times</span><span class="p">,</span> <span class="n">exact_energies</span><span class="p">,</span> <span class="n">exact_magnetizations</span> <span class="o">=</span> <span class="n">exact</span><span class="p">(</span>
    <span class="n">final_time</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="n">hamiltonian</span><span class="p">,</span> <span class="n">initial_state</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">magnetizations</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">observables</span><span class="p">)[:,</span> <span class="mi">1</span><span class="p">]</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">times</span><span class="p">,</span> <span class="n">magnetizations</span><span class="o">.</span><span class="n">real</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;crimson&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;PVQD&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">exact_times</span><span class="p">,</span> <span class="n">exact_magnetizations</span><span class="p">,</span> <span class="s2">&quot;:&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Exact&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;time $t$&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;magnetization $\langle Z_1 Z_2 \rangle$&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Magnetization over time&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s2">&quot;best&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_10_pvqd_23_0.png" src="../_images/tutorials_10_pvqd_23_0.png" />
</div>
</div>
<p>Looks pretty good!</p>
<section id="Gradient-based-optimizations">
<h2>Gradient-based optimizations<a class="headerlink" href="#Gradient-based-optimizations" title="Link to this heading">¶</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">PVQD</span></code> class also implements parameter-shift gradients for the loss function and we can use a gradient descent optimization routine</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\theta_{k+1} = \theta_{k} - \eta_k \nabla\ell(\theta_k).\]</div>
</div>
<p>Here we’re using a learning rate of</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\eta_k = 0.1 k^{-0.602}\]</div>
</div>
<p>and 80 optimization steps in each timestep.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">qiskit_algorithms.optimizers</span><span class="w"> </span><span class="kn">import</span> <span class="n">GradientDescent</span>

<span class="n">maxiter</span> <span class="o">=</span> <span class="mi">80</span>
<span class="n">learning_rate</span> <span class="o">=</span> <span class="mf">0.1</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">maxiter</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">**</span> <span class="p">(</span><span class="o">-</span><span class="mf">0.602</span><span class="p">)</span>
<span class="n">gd</span> <span class="o">=</span> <span class="n">GradientDescent</span><span class="p">(</span><span class="n">maxiter</span><span class="p">,</span> <span class="k">lambda</span><span class="p">:</span> <span class="nb">iter</span><span class="p">(</span><span class="n">learning_rate</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pvqd</span><span class="o">.</span><span class="n">optimizer</span> <span class="o">=</span> <span class="n">gd</span>
</pre></div>
</div>
</div>
<p>The following cell would take a few minutes to run for 100 timesteps, so we reduce them here.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">n</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">pvqd</span><span class="o">.</span><span class="n">num_timesteps</span> <span class="o">=</span> <span class="n">n</span>
<span class="n">problem</span><span class="o">.</span><span class="n">time</span> <span class="o">=</span> <span class="mf">0.1</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">result_gd</span> <span class="o">=</span> <span class="n">pvqd</span><span class="o">.</span><span class="n">evolve</span><span class="p">(</span><span class="n">problem</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">energies_gd</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">result_gd</span><span class="o">.</span><span class="n">observables</span><span class="p">)[:,</span> <span class="mi">0</span><span class="p">]</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">times</span><span class="p">[:</span> <span class="n">n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">],</span> <span class="n">energies</span><span class="p">[:</span> <span class="n">n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">],</span> <span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;royalblue&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;BFGS&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">result_gd</span><span class="o">.</span><span class="n">times</span><span class="p">,</span> <span class="n">energies_gd</span><span class="p">,</span> <span class="s2">&quot;--&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;royalblue&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Gradient descent&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">exact_times</span><span class="p">[:</span> <span class="n">n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">],</span> <span class="n">exact_energies</span><span class="p">[:</span> <span class="n">n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">],</span> <span class="s2">&quot;:&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Exact&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s2">&quot;best&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;time $t$&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;energy $E$&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Energy over time&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Text(0.5, 1.0, &#39;Energy over time&#39;)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_10_pvqd_31_1.png" src="../_images/tutorials_10_pvqd_31_1.png" />
</div>
</div>
<p>We can observe here, that the energy does vary quite a bit! But as we mentioned before, p-VQD does not preserve the energy.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">magnetizations_gd</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">result_gd</span><span class="o">.</span><span class="n">observables</span><span class="p">)[:,</span> <span class="mi">1</span><span class="p">]</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">times</span><span class="p">[:</span> <span class="n">n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">],</span> <span class="n">magnetizations</span><span class="p">[:</span> <span class="n">n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">],</span> <span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;crimson&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;BFGS&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">result_gd</span><span class="o">.</span><span class="n">times</span><span class="p">,</span> <span class="n">magnetizations_gd</span><span class="p">,</span> <span class="s2">&quot;--&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;crimson&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Gradient descent&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">exact_times</span><span class="p">[:</span> <span class="n">n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">],</span> <span class="n">exact_magnetizations</span><span class="p">[:</span> <span class="n">n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">],</span> <span class="s2">&quot;:&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Exact&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s2">&quot;best&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;time $t$&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;magnetization $\langle Z_1 + Z_2 \rangle$&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Magnetization over time&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Text(0.5, 1.0, &#39;Magnetization over time&#39;)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_10_pvqd_33_1.png" src="../_images/tutorials_10_pvqd_33_1.png" />
</div>
</div>
<p>The magnetization, however, is computed very precisely.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">tutorial_magics</span>

<span class="o">%</span><span class="k">qiskit_version_table</span>
<span class="o">%</span><span class="k">qiskit_copyright</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<h3>Version Information</h3><table><tr><th>Software</th><th>Version</th></tr><tr><td><code>qiskit</code></td><td>2.0.3</td></tr><tr><td><code>qiskit_algorithms</code></td><td>0.4.0</td></tr><tr><th colspan='2'>System information</th></tr><tr><td>Python version</td><td>3.10.18</td></tr><tr><td>OS</td><td>Linux</td></tr><tr><td colspan='2'>Wed Sep 03 20:09:04 2025 UTC</td></tr></table></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<div style='width: 100%; background-color:#d5d9e0;padding-left: 10px; padding-bottom: 10px; padding-right: 10px; padding-top: 5px'><h3>This code is a part of a Qiskit project</h3><p>&copy; Copyright IBM 2017, 2025.</p><p>This code is licensed under the Apache License, Version 2.0. You may<br>obtain a copy of this license in the LICENSE.txt file in the root directory<br> of this source tree or at http://www.apache.org/licenses/LICENSE-2.0.<p>Any modifications or derivative works of this code must retain this<br>copyright notice, and modified files need to carry a notice indicating<br>that they have been altered from the originals.</p></div></div>
</div>
</section>
</section>

        </article>
      </div>
      <footer>
        <div class="related-pages">
          <a class="next-page" href="11_VarQTE.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Variational Quantum Time Evolution</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="07_grover_examples.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Grover’s algorithm examples</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2017-2025, Qiskit Algorithms Development Team
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            <div class="last-updated">
              Last updated on 2025/09/03</div>
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Projected Variational Quantum Dynamics</a><ul>
<li><a class="reference internal" href="#Gradient-based-optimizations">Gradient-based optimizations</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="../_static/jquery.js?v=5d32c60e"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
    <script src="../_static/documentation_options.js?v=6c02275b"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/scripts/qiskit-sphinx-theme.js?v=4d77b8ca"></script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    </body>
</html>